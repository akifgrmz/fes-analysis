geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Effort_Type+Test) +
theme_minimal() +
labs(
title = "Counts by Stim and Voli Category per Effort Type",
x = "Stim Category",
y = "Count"
)
ggplot(df_summary, aes(x = MVC_Voli_Cat, fill = MVC_Stim_Cat)) +
geom_histogram(binwidth = 1, color = "black", alpha = 0.7, position = "identity") +
facet_wrap(~Effort_Type+Test) +
theme_minimal() +
labs(
title = "Histogram of Counts per Stim Category within Each Effort Type",
x = "Number of Entries",
y = "Frequency"
)
df_summary <- plot_rmse %>%
group_by(Effort_Type, MVC_Stim_Cat, MVC_Voli_Cat, Test, Filt) %>%
summarise(Count = n(), .groups = "drop")
ggplot(df_summary, aes(x = MVC_Stim_Cat, y = Count, fill = MVC_Voli_Cat)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Effort_Type+Test) +
theme_minimal() +
labs(
title = "Counts by Stim and Voli Category per Effort Type",
x = "Stim Category",
y = "Count"
)
ggplot(df_summary, aes(x = MVC_Stim_Cat , fill = Count)) +
geom_histogram(binwidth = 1, color = "black", alpha = 0.7, position = "identity") +
facet_wrap(~Effort_Type+Test) +
theme_minimal() +
labs(
title = "Histogram of Counts per Stim Category within Each Effort Type",
x = "Number of Entries",
y = "Frequency"
)
df_summary <- plot_rmse %>%
group_by(Effort_Type, MVC_Stim_Cat, MVC_Voli_Cat, Test, Filt) %>%
summarise(Count = n(), .groups = "drop")
ggplot(df_summary, aes(x = MVC_Stim_Cat, y = Count, fill = MVC_Voli_Cat)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Effort_Type+Test) +
theme_minimal() +
labs(
title = "Counts by Stim and Voli Category per Effort Type",
x = "Stim Category",
y = "Count"
)
ggplot(df_summary, aes(x = Count, fill = MVC_Stim_Cat)) +
geom_histogram(binwidth = 1, color = "black", alpha = 0.7, position = "identity") +
facet_wrap(~Effort_Type+Test) +
theme_minimal() +
labs(
title = "Histogram of Counts per Stim Category within Each Effort Type",
x = "Number of Entries",
y = "Frequency"
)
df_summary <- plot_rmse %>%
group_by(Effort_Type, MVC_Stim_Cat, MVC_Voli_Cat, Test, Filt) %>%
summarise(Count = n(), .groups = "drop")
ggplot(df_summary, aes(x = MVC_Stim_Cat, y = Count, fill = MVC_Voli_Cat)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Effort_Type+Test) +
theme_minimal() +
labs(
title = "Counts by Stim and Voli Category per Effort Type",
x = "Stim Category",
y = "Count"
)
# Identify reference subset (Filt == "Ref")
ref_data <- plot_rmse %>% filter(Filt == "Ref")
# Run ANOVA for each filter (excluding Ref)
anova_results <- plot_rmse %>%
filter(Filt != "Ref") %>%
group_by(Filt) %>%
do({
# Combine current filter data with reference
df <- bind_rows(., ref_data)
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model)
}) %>%
ungroup()
# Identify reference subset (Filt == "Ref")
ref_data <- plot_rmse %>% filter(Filt == "Ref")
# Run ANOVA for each filter (excluding Ref)
anova_results <- plot_rmse %>%
filter(Filt != "Ref") %>%
group_by(Filt) %>%
do({
# Combine current filter data with reference
df <- bind_rows(., ref_data)
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model)
}) %>%
ungroup()
anova_results %>%
select(Filt, term, statistic, p.value) %>%
filter(term %in% c("MVC_Voli_Cat", "Filt", "MVC_Voli_Cat:Filt"))
# Identify reference subset (Filt == "Ref")
plot_rmse <- plot_rmse %>%
mutate(
Effort_Type = as.factor(Effort_Type),
MVC_Voli_Cat = as.factor(MVC_Voli_Cat),
Filt = as.factor(Filt)
)
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt) %>%
group_modify(~{
if (unique(.x$Filt) == "Ref") return(NULL)  # skip Ref itself
# reference data (same Effort_Type, Filt == "Ref")
ref_data <- plot_rmse %>%
filter(Effort_Type == unique(.x$Effort_Type), Filt == "Ref")
# combine current + reference
df <- bind_rows(.x, ref_data)
# run ANOVA
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model) %>%
mutate(Filt = unique(.x$Filt))
}) %>%
ungroup()
# Identify reference subset (Filt == "Ref")
plot_rmse <- plot_rmse %>%
mutate(
Effort_Type = as.factor(Effort_Type),
MVC_Voli_Cat = as.factor(MVC_Voli_Cat),
Filt = as.factor(Filt)
)
ref_data <- plot_rmse %>% filter(Filt == "Ref")
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt) %>%
group_modify(~{
if (unique(.x$Filt) == "Ref") return(NULL)  # skip Ref itself
# reference data (same Effort_Type, Filt == "Ref")
ref_data <- plot_rmse %>%
filter(Effort_Type == unique(.x$Effort_Type), Filt == "Ref")
# combine current + reference
df <- bind_rows(.x, ref_data)
# run ANOVA
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model) %>%
mutate(Filt = unique(.x$Filt))
}) %>%
ungroup()
# Identify reference subset (Filt == "Ref")
plot_rmse <- plot_rmse %>%
mutate(
Effort_Type = as.factor(Effort_Type),
MVC_Voli_Cat = as.factor(MVC_Voli_Cat),
Filt = as.factor(Filt)
)
ref_data <- plot_rmse %>% filter(Filt == "Ref")
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt) %>%
group_modify(~{
if (unique(.x$Filt) == "Ref") return(NULL)  # skip Ref itself
# reference data (same Effort_Type, Filt == "Ref")
ref_data <- plot_rmse %>%
filter(Effort_Type == unique(.x$Effort_Type), Filt == "Ref")
# combine current + reference
df <- bind_rows(.x, ref_data)
# run ANOVA
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model) %>%
mutate(Filt = unique(.x$Filt))
}) %>%
ungroup()
# Identify reference subset (Filt == "Ref")
plot_rmse <- plot_rmse %>%
mutate(
Effort_Type = as.factor(Effort_Type),
MVC_Voli_Cat = as.factor(MVC_Voli_Cat),
Filt = as.factor(Filt)
)
ref_data <- plot_rmse %>% filter(Filt == "Ref")
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt) %>%
group_modify(~{
if (unique(.x$Filt) == "Ref") return(NULL)  # skip Ref itself
# reference data (same Effort_Type, Filt == "Ref")
ref_data <- plot_rmse %>%
filter(Effort_Type == unique(.x$Effort_Type), Filt == "Ref")
# combine current + reference
df <- bind_rows(.x, ref_data)
# run ANOVA
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model) %>%
mutate(Filt = unique(.x$Filt))
}) %>%
ungroup()
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt) %>%
group_modify(~{
if (unique(.x$Filt) == "Ref") return(NULL)  # skip Ref itself
# reference data (same Effort_Type, Filt == "Ref")
ref_data <- plot_rmse %>%
filter(Effort_Type == unique(.x$Effort_Type), Filt == "Ref")
# combine current + reference
df <- bind_rows(.x, ref_data)
# run ANOVA
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model) %>%
mutate(Filt = unique(.x$Filt))
}) %>%
ungroup()
View(plot_rmse)
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt) %>%
group_modify(~{
if (unique(.x$Filt) == "Ref") return(NULL)  # skip Ref itself
# reference data (same Effort_Type, Filt == "Ref")
ref_data <- plot_rmse %>%
filter(Effort_Type == unique(.x$Effort_Type), Filt == "Unfilt")
# combine current + reference
df <- bind_rows(.x, ref_data)
# run ANOVA
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model) %>%
mutate(Filt = unique(.x$Filt))
}) %>%
ungroup()
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt) %>%
group_modify(~{
if (unique(.x$Filt) == "Unfilt") return(NULL)  # skip Ref itself
# reference data (same Effort_Type, Filt == "Ref")
ref_data <- plot_rmse %>%
filter(Effort_Type == unique(.x$Effort_Type), Filt == "Unfilt")
# combine current + reference
df <- bind_rows(.x, ref_data)
# run ANOVA
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model) %>%
mutate(Filt = unique(.x$Filt))
}) %>%
ungroup()
View(plot_rmse)
library(dplyr)
library(broom)
anova_results <- plot_rmse %>%
# Make sure these are factors
mutate(
Effort_Type = as.factor(Effort_Type),
Filt = as.factor(Filt),
MVC_Voli_Cat = as.factor(MVC_Voli_Cat)
) %>%
# Group by effort and filter
group_by(Effort_Type, Filt) %>%
group_modify(~{
# Skip empty groups safely
if (nrow(.x) == 0) return(tibble())
current_filt <- unique(.x$Filt)
if (length(current_filt) == 0 || current_filt == "Unfilt") return(tibble())
# Get reference data for the same Effort_Type
ref_data <- plot_rmse %>%
filter(Effort_Type == unique(.x$Effort_Type), Filt == "Unfilt")
# If no reference exists, skip
if (nrow(ref_data) == 0) return(tibble())
# Combine reference and current data
df <- bind_rows(.x, ref_data)
# Run ANOVA
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model) %>%
mutate(Filt = current_filt)
}) %>%
ungroup()
library(dplyr)
library(broom)
anova_results <- plot_rmse %>%
# Make sure these are factors
mutate(
Effort_Type = as.factor(Effort_Type),
Filt = as.factor(Filt),
MVC_Voli_Cat = as.factor(MVC_Voli_Cat)
) %>%
# Group by effort and filter
group_by(Effort_Type, Filt) %>%
group_modify(~{
# Skip empty groups safely
if (nrow(.x) == 0) return(tibble())
current_filt <- unique(.x$Filt)
if (length(current_filt) == 0 || current_filt == "Unfilt") return(tibble())
# Get reference data for the same Effort_Type
ref_data <- plot_rmse %>%
filter(Effort_Type == unique(.x$Effort_Type), Filt == "Unfilt")
# If no reference exists, skip
if (nrow(ref_data) == 0) return(tibble())
# Combine reference and current data
df <- bind_rows(.x, ref_data)
# Run ANOVA
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model) %>%
mutate(Filt = current_filt)
}) %>%
ungroup()
anova_results %>%
select(Effort_Type, Filt, term, statistic, p.value) %>%
filter(term %in% c("MVC_Voli_Cat", "Filt", "MVC_Voli_Cat:Filt")) %>%
arrange(Effort_Type, Filt, term)
View(anova_results)
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt) %>%
group_modify(~{
if (unique(.x$Filt) == "Unfilt") return(NULL)  # skip Ref itself
# reference data (same Effort_Type, Filt == "Ref")
ref_data <- plot_rmse %>%
filter(Effort_Type == unique(.x$Effort_Type), Filt == "Unfilt")
# combine current + reference
df <- bind_rows(.x, ref_data)
# run ANOVA
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
tidy(model) %>%
mutate(Filt = unique(.x$Filt))
}) %>%
ungroup()
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt) %>%
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt)
View(anova_results)
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt)
anova_results <- list()
for (effort in unique(plot_rmse$Effort_Type)) {
effort_data <- plot_rmse %>% filter(Effort_Type == effort)
for (pair in comparisons) {
filt_levels <- pair
df <- effort_data %>%
filter(Filt %in% filt_levels)
# skip if missing levels
if (length(unique(df$Filt)) < 2) next
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
res <- tidy(model) %>%
mutate(
Effort_Type = effort,
Comparison = paste(filt_levels, collapse = " vs ")
)
anova_results[[length(anova_results) + 1]] <- res
}
}
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt)
anova_results <- list()
comparisons = list(c("Ref", "GS"), c("Ref", "Comb"), c("Ref", "Unfilt"))
for (effort in unique(plot_rmse$Effort_Type)) {
effort_data <- plot_rmse %>% filter(Effort_Type == effort)
for (pair in comparisons) {
filt_levels <- pair
df <- effort_data %>%
filter(Filt %in% filt_levels)
# skip if missing levels
if (length(unique(df$Filt)) < 2) next
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
res <- tidy(model) %>%
mutate(
Effort_Type = effort,
Comparison = paste(filt_levels, collapse = " vs ")
)
anova_results[[length(anova_results) + 1]] <- res
}
}
anova_results <- bind_rows(anova_results)
View(anova_results)
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt)
anova_results <- list()
comparisons = list(c("Ref", "GS"), c("Ref", "Comb"), c("Ref", "Unfilt"))
for (effort in unique(plot_rmse$Effort_Type)) {
effort_data <- plot_rmse %>% filter(Effort_Type == effort)
for (pair in comparisons) {
filt_levels <- pair
df <- effort_data %>%
filter(Filt %in% filt_levels)
# skip if missing levels
if (length(unique(df$Filt)) < 2) next
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
res <- tidy(model) %>%
mutate(
Effort_Type = effort,
Comparison = paste(filt_levels, collapse = " vs ")
)
anova_results[[length(anova_results) + 1]] <- res
}
}
anova_results <- bind_rows(anova_results)
anova_results <- plot_rmse %>%
group_by(Effort_Type, Filt)
anova_results <- list()
comparisons = list(c("Ref", "GS"), c("Ref", "Comb"), c("Ref", "Unfilt"))
for (effort in unique(plot_rmse$Effort_Type)) {
effort_data <- plot_rmse %>% filter(Effort_Type == effort)
for (pair in comparisons) {
filt_levels <- pair
df <- effort_data %>%
filter(Filt %in% filt_levels)
# skip if missing levels
if (length(unique(df$Filt)) < 2) next
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = df)
res <- tidy(model) %>%
mutate(
Effort_Type = effort,
Comparison = paste(filt_levels, collapse = " vs ")
)
anova_results[[length(anova_results) + 1]] <- res
}
}
anova_results <- bind_rows(anova_results)
anova_summary <- anova_results %>%
select(Effort_Type, Comparison, term, statistic, p.value) %>%
filter(term %in% c("MVC_Voli_Cat", "Filt", "MVC_Voli_Cat:Filt")) %>%
arrange(Effort_Type, Comparison, term)
print(anova_summary)
force<-plot_rmse %>%filter(Effort_Type="Force")
force<-plot_rmse %>%filter(Effort_Type=="Force")
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = force)
force<-plot_rmse %>%filter(Effort_Type=="Force")
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = force)
tidy_results <- tidy(model)
print(tidy_results)
force<-plot_rmse %>%filter(Effort_Type=="Force")
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = force)
tidy_results <- tidy(model)
print(tidy_results)
tidy_results %>%
mutate(across(where(is.numeric), round, 4)) %>%
select(term, df, statistic, p.value, sumsq, meansq)
force<-plot_rmse %>%filter(Effort_Type=="Force")
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = force)
tidy_results <- tidy(model)
print(tidy_results)
tidy_results %>%
mutate(across(where(is.numeric), round, 4)) %>%
select(term, df, statistic, p.value, sumsq, meansq)
interaction.plot(force$MVC_Voli_Cat, force$Filt, force$Error,
col = 1:4, lwd = 2,
xlab = "MVC Voluntary Category",
ylab = "Mean Error",
trace.label = "Filter Type")
force<-plot_rmse %>%filter(Effort_Type=="Force")
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = force)
tidy_results <- tidy(model)
print(tidy_results)
tidy_results %>%
mutate(across(where(is.numeric), round, 4)) %>%
select(term, df, statistic, p.value, sumsq, meansq)
# Post-hoc for Filt
TukeyHSD(model, "Filt")
# Post-hoc for MVC_Voli_Cat
TukeyHSD(model, "MVC_Voli_Cat")
force<-plot_rmse %>%filter(Effort_Type=="Force")
model <- aov(Error ~ MVC_Voli_Cat + Filt, data = force)
tidy_results <- tidy(model)
print(tidy_results)
tidy_results %>%
mutate(across(where(is.numeric), round, 4)) %>%
select(term, df, statistic, p.value, sumsq, meansq)
# Post-hoc for Filt
TukeyHSD(model, "Filt")
# Post-hoc for MVC_Voli_Cat
TukeyHSD(model, "MVC_Voli_Cat")
force<-plot_rmse %>%filter(Effort_Type=="Force")
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = force)
tidy_results <- tidy(model)
print(tidy_results)
tidy_results %>%
mutate(across(where(is.numeric), round, 4)) %>%
select(term, df, statistic, p.value, sumsq, meansq)
# Post-hoc for Filt
TukeyHSD(model, "Filt")
# Post-hoc for MVC_Voli_Cat
TukeyHSD(model, "MVC_Voli_Cat")
View(plot_rmse)
force<-plot_rmse %>%filter(Effort_Type=="Hand")
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = force)
tidy_results %>%
mutate(across(where(is.numeric), round, 4)) %>%
select(term, df, statistic, p.value, sumsq, meansq)
# Post-hoc for Filt
TukeyHSD(model, "Filt")
# Post-hoc for MVC_Voli_Cat
TukeyHSD(model, "MVC_Voli_Cat")
force<-plot_rmse %>%filter(Effort_Type=="Hand")
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = force)
tidy_results %>%
mutate(across(where(is.numeric), round, 4)) %>%
select(term, df, statistic, p.value, sumsq, meansq)
# Post-hoc for Filt
TukeyHSD(model, "Filt")
# Post-hoc for MVC_Voli_Cat
TukeyHSD(model, "MVC_Voli_Cat")
pairwise_wilcox_filt <- plot_rmse %>%
filter(Effort_Type == "Force") %>%
group_by(MVC_Voli_Cat) %>%
pairwise_wilcox_test(
Error ~ Filt,
p.adjust.method = "bonferroni"
)
install.packages("rstatix")
knitr::opts_chunk$set(echo = TRUE)
library(rstatix)
force<-plot_rmse %>%filter(Effort_Type=="Hand")
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = force)
tidy_results %>%
mutate(across(where(is.numeric), round, 4)) %>%
select(term, df, statistic, p.value, sumsq, meansq)
library(rstatix)
force<-plot_rmse %>%filter(Effort_Type=="Hand")
model <- aov(Error ~ MVC_Voli_Cat * Filt, data = force)
tidy_results %>%
mutate(across(where(is.numeric), round, 4)) %>%
select(term, df, statistic, p.value, sumsq, meansq)
