library(dplyr)
library(ggplot2)
library(ggpmisc)
library(tidyr)
library(ggsignif)
options(dplyr.summarise.inform = FALSE)
coefraw<- read_csv("occ_coef2.csv",show_col_types = FALSE)
droppedocc<- read_csv("dropped_occ6.csv",show_col_types = FALSE)
occraw<- read_csv("occlusion_v7.csv",show_col_types = FALSE)
err_raw<- read_csv("occ_est_error4.csv",show_col_types = FALSE)
occ<-occraw%>%mutate(Test = as.factor(Test),
Tau = as.factor(Tau),
Feat = as.factor(Feat),
Filt = as.factor(Filt))
occ<-occ%>%mutate(MVC_Voli_Cat=recode(MVC_Voli,
'10' = 'Voli_10',
'20' = 'Voli_20',
'30' = 'Voli_30',
'40' = 'Voli_40',
'50' = 'Voli_50')) %>%
mutate(MVC_Stim_Cat=recode(MVC_Stim,
'0' = 'Stim_0',
'10' = 'Stim_10',
'20' = 'Stim_20',
'30' = 'Stim_30',
'40' = 'Stim_40'))
occ<-occ%>%filter(Test!="mar7",Test!="mar16",Test!="feb27",Test!="apr20")
droppedocc<-droppedocc%>%mutate(Test = as.factor(Test),
Repeat = as.factor(Repeat),
NumofDropped = as.factor(NumofDropped))
droppedocc<-droppedocc%>%mutate(MVC_Voli_Cat=recode(MVC_Voli,
'10' = 'Voli_10',
'20' = 'Voli_20',
'30' = 'Voli_30',
'40' = 'Voli_40',
'50' = 'Voli_50')) %>%
mutate(MVC_Stim_Cat=recode(MVC_Stim,
'0' = 'Stim_0',
'10' = 'Stim_10',
'20' = 'Stim_20',
'30' = 'Stim_30',
'40' = 'Stim_40'))
err<-err_raw%>%mutate(MVC_Voli_Cat=recode(VoliMVC,
'10' = 'Voli_10',
'20' = 'Voli_20',
'30' = 'Voli_30',
'40' = 'Voli_40',
'50' = 'Voli_50')) %>%
mutate(MVC_Stim_Cat=recode(StimMVC,
'0' = 'Stim_0',
'10' = 'Stim_10',
'20' = 'Stim_20',
'30' = 'Stim_30',
'40' = 'Stim_40'))
err<-err%>%mutate(Test = as.factor(Test),
Filt = as.factor(Filt),
Occ_Type = as.factor(Occ_Type),
MVC_Stim_Cat = as.factor(MVC_Stim_Cat),
MVC_Voli_Cat = as.factor(MVC_Voli_Cat),
MVC_Stim = as.integer(StimMVC),
MVC_Voli = as.integer(VoliMVC))
err<-err%>%filter(Test!="mar7",Test!="mar16",Test!="feb27",Test!="apr20")
coef<-coefraw%>%mutate(Test = as.factor(Test),
Type = as.factor(Type),
Trial = as.integer(Trial))
coef<-coef%>%mutate(MVC_Voli_Cat=recode(MVC_Voli,
'10' = 'Voli_10',
'20' = 'Voli_20',
'30' = 'Voli_30',
'40' = 'Voli_40')) %>%
mutate(MVC_Stim_Cat=recode(MVC_Stim,
'0' = 'Stim_0',
'10' = 'Stim_10',
'20' = 'Stim_20',
'30' = 'Stim_30'))
coef<-coef%>%filter(Test!="mar7",Test!="mar16",Test!="feb27",Test!="apr20")
summary(occ)
plot_tibble<-filter(occ, MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt',Feat!='Amp_Modul')
NumofTest<-length(unique(plot_tibble$Test) )
ggplot(plot_tibble, aes(x =  MVC_Voli , y = vprime_mvc , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 10, xend = 40, yend = 40, color='No Occlusion Level'))+
facet_wrap(EffortType~Feat)+
ylim(-10,200)
labs(x = "Volitional Effort: E_v (% MVC)",
y = "Maintained Volitional effort: E_vprime (% MVC)",
title = "Maintained force and MAV for different effort levels and stim levels",
subtitle = sprintf("%d able-body participants",length(unique(plot_tibble$Test) )))
lm_tibble<-filter(occ, MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt',Feat=='EffortMea')
#lm_tibble <- lm_tibble %>%
#  mutate(Test = relevel(Test, ref = "jan7"))
# m1 <- lm(Occ_mvc ~ MVC_Voli + MVC_Stim , data = lm_tibble)
#tidy(m1,conf.int = TRUE ,conf.level =0.95) %>% knitr::kable(digits = 3)
# m2 <- lm(Occ_Dropped_mvc ~ (MVC_Voli + MVC_Stim), data = lm_tibble)
#tidy(m2,conf.int = TRUE ,conf.level =0.95) %>% knitr::kable(digits = 3)
plot_tibble<-filter(occ, MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt',Feat!='Amp_Modul',EffortType=="Hand")
tibblelong<-plot_tibble%>%pivot_longer(cols=c('Occ_mvc','Occ_Dropped_mvc','Occ_Hybrid_mvc'),
names_to='Occlusion_Type',
values_to='Occlusion_Val')%>%mutate(Occlusion_Type = as.factor(Occlusion_Type))
tibblelong2<-filter(tibblelong, MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt',Feat=='EffortMea')
p1<-ggplot(plot_tibble, aes(x =  MVC_Voli , y = Occ_mvc , color =Feat )) +
geom_point() +
geom_smooth(method = "lm")+
facet_wrap(~MVC_Stim_Cat)+
ylim(-20, 90)+
labs(x = "Volitional Effort: E_v (% MVC)",
y = "Occlusion (% MVC)",
title = "Occluded force and MAV",
subtitle = sprintf("%d able-body participants",length(unique(plot_tibble$Test) )))
p2<-ggplot(tibblelong2, aes(x =  v_mvc , y = Occlusion_Val , color =Occlusion_Type )) +
geom_point() +
geom_smooth(method = "lm")+
facet_wrap(~MVC_Stim_Cat,scales="free")+
labs(x = "Volitional Effort: E_v (% MVC)",
y = "Occlusion (% MVC)",
title = "Occluded force and MAV",
subtitle = sprintf("%d able-body participants",length(unique(plot_tibble$Test) )))
p1/p2
knitr::opts_chunk$set(echo = TRUE)
library(magrittr);
library(here);
library(janitor)
library(readxl);
library(tidyverse)
library(rmdformats)
library(Epi)
library(vcd)
library(broom)
library(patchwork)
library(vcd)
library(dplyr)
library(ggplot2)
library(ggpmisc)
library(tidyr)
library(ggsignif)
options(dplyr.summarise.inform = FALSE)
coefraw<- read_csv("occ_coef2.csv",show_col_types = FALSE)
droppedocc<- read_csv("dropped_occ6.csv",show_col_types = FALSE)
occraw<- read_csv("occlusion_v7.csv",show_col_types = FALSE)
err_raw<- read_csv("occ_est_error4.csv",show_col_types = FALSE)
occ<-occraw%>%mutate(Test = as.factor(Test),
Tau = as.factor(Tau),
Feat = as.factor(Feat),
Filt = as.factor(Filt))
occ<-occ%>%mutate(MVC_Voli_Cat=recode(MVC_Voli,
'10' = 'Voli_10',
'20' = 'Voli_20',
'30' = 'Voli_30',
'40' = 'Voli_40',
'50' = 'Voli_50')) %>%
mutate(MVC_Stim_Cat=recode(MVC_Stim,
'0' = 'Stim_0',
'10' = 'Stim_10',
'20' = 'Stim_20',
'30' = 'Stim_30',
'40' = 'Stim_40'))
occ<-occ%>%filter(Test!="mar7",Test!="mar16",Test!="feb27",Test!="apr20")
droppedocc<-droppedocc%>%mutate(Test = as.factor(Test),
Repeat = as.factor(Repeat),
NumofDropped = as.factor(NumofDropped))
droppedocc<-droppedocc%>%mutate(MVC_Voli_Cat=recode(MVC_Voli,
'10' = 'Voli_10',
'20' = 'Voli_20',
'30' = 'Voli_30',
'40' = 'Voli_40',
'50' = 'Voli_50')) %>%
mutate(MVC_Stim_Cat=recode(MVC_Stim,
'0' = 'Stim_0',
'10' = 'Stim_10',
'20' = 'Stim_20',
'30' = 'Stim_30',
'40' = 'Stim_40'))
err<-err_raw%>%mutate(MVC_Voli_Cat=recode(VoliMVC,
'10' = 'Voli_10',
'20' = 'Voli_20',
'30' = 'Voli_30',
'40' = 'Voli_40',
'50' = 'Voli_50')) %>%
mutate(MVC_Stim_Cat=recode(StimMVC,
'0' = 'Stim_0',
'10' = 'Stim_10',
'20' = 'Stim_20',
'30' = 'Stim_30',
'40' = 'Stim_40'))
err<-err%>%mutate(Test = as.factor(Test),
Filt = as.factor(Filt),
Occ_Type = as.factor(Occ_Type),
MVC_Stim_Cat = as.factor(MVC_Stim_Cat),
MVC_Voli_Cat = as.factor(MVC_Voli_Cat),
MVC_Stim = as.integer(StimMVC),
MVC_Voli = as.integer(VoliMVC))
err<-err%>%filter(Test!="mar7",Test!="mar16",Test!="feb27",Test!="apr20")
coef<-coefraw%>%mutate(Test = as.factor(Test),
Type = as.factor(Type),
Trial = as.integer(Trial))
coef<-coef%>%mutate(MVC_Voli_Cat=recode(MVC_Voli,
'10' = 'Voli_10',
'20' = 'Voli_20',
'30' = 'Voli_30',
'40' = 'Voli_40')) %>%
mutate(MVC_Stim_Cat=recode(MVC_Stim,
'0' = 'Stim_0',
'10' = 'Stim_10',
'20' = 'Stim_20',
'30' = 'Stim_30'))
coef<-coef%>%filter(Test!="mar7",Test!="mar16",Test!="feb27",Test!="apr20")
summary(occ)
plot_tibble<-filter(occ, MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt',Feat!='Amp_Modul')
NumofTest<-length(unique(plot_tibble$Test) )
ggplot(plot_tibble, aes(x =  MVC_Voli , y = vprime_mvc , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 10, xend = 40, yend = 40, color='No Occlusion Level'))+
facet_wrap(EffortType~Feat)+
ylim(-10,200)
labs(x = "Volitional Effort: E_v (% MVC)",
y = "Maintained Volitional effort: E_vprime (% MVC)",
title = "Maintained force and MAV for different effort levels and stim levels",
subtitle = sprintf("%d able-body participants",length(unique(plot_tibble$Test) )))
lm_tibble<-filter(occ, MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt',Feat=='EffortMea')
#lm_tibble <- lm_tibble %>%
#  mutate(Test = relevel(Test, ref = "jan7"))
# m1 <- lm(Occ_mvc ~ MVC_Voli + MVC_Stim , data = lm_tibble)
#tidy(m1,conf.int = TRUE ,conf.level =0.95) %>% knitr::kable(digits = 3)
# m2 <- lm(Occ_Dropped_mvc ~ (MVC_Voli + MVC_Stim), data = lm_tibble)
#tidy(m2,conf.int = TRUE ,conf.level =0.95) %>% knitr::kable(digits = 3)
plot_tibble<-filter(occ, MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt',Feat!='Amp_Modul',EffortType=="Hand")
tibblelong<-plot_tibble%>%pivot_longer(cols=c('Occ_mvc','Occ_Dropped_mvc','Occ_Hybrid_mvc'),
names_to='Occlusion_Type',
values_to='Occlusion_Val')%>%mutate(Occlusion_Type = as.factor(Occlusion_Type))
tibblelong2<-filter(tibblelong, MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt',Feat=='EffortMea')
p1<-ggplot(plot_tibble, aes(x =  MVC_Voli , y = Occ_mvc , color =Feat )) +
geom_point() +
geom_smooth(method = "lm")+
facet_wrap(~MVC_Stim_Cat)+
ylim(-20, 90)+
labs(x = "Volitional Effort: E_v (% MVC)",
y = "Occlusion (% MVC)",
title = "Occluded force and MAV",
subtitle = sprintf("%d able-body participants",length(unique(plot_tibble$Test) )))
p2<-ggplot(tibblelong2, aes(x =  v_mvc , y = Occlusion_Val , color =Occlusion_Type )) +
geom_point() +
geom_smooth(method = "lm")+
facet_wrap(~MVC_Stim_Cat,scales="free")+
labs(x = "Volitional Effort: E_v (% MVC)",
y = "Occlusion (% MVC)",
title = "Occluded force and MAV",
subtitle = sprintf("%d able-body participants",length(unique(plot_tibble$Test) )))
p1/p2
plot_tibble<-filter(occ, MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt',Feat=='EffortMea')
occ_err_long<-plot_tibble%>%pivot_longer(cols=c('Occ_mvc','vprime_mvc'),
names_to='Occlusion_Type',
values_to='Occlusion_Val')%>%mutate(Occlusion_Type = as.factor(Occlusion_Type))
#%>%mutate(Occlusion_Type=recode(
#                                    Occlusion_Type,'Occ_mvc' = 'Force Occlusion (E_o)' ,
#                                               'vprime_mvc' = 'Maintained Levels (E_v^prime)'))
occ_err_long <- occ_err_long %>%
mutate(Occlusion_Type = relevel(Occlusion_Type, ref = "vprime_mvc"))
my_labeller <- as_labeller(c(Occ_mvc="E[o]", vprime_mvc="E[v]^I"),
default = label_parsed)
p1<-ggplot(occ_err_long, aes(x =  v_mvc , y = Occlusion_Val , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
facet_wrap(~Occlusion_Type,scales='free',labeller = my_labeller)+
#ylim(-20,75)+
labs(x = expression("Volitional Effort (E"[v]*") ") ,
y = "% Effort",
title = "",
subtitle = "                        (b)                                                      (c)")+
scale_color_hue(labels=c('10% Stim', '20% Stim', '30% Stim'),name= expression("Stimulated Effort (E"[s]*")"))+
theme(legend.position = c(0.7, 0.16))
#pdf("conf1_ver4.pdf")
suppressWarnings(print(p1))
#dev.off()
simp_tipple<-filter(occ, MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt',Feat=='EffortMea')%>%
select(Occ_mvc,Occ_Dropped_mvc,MVC_Stim_Cat,MVC_Voli,MVC_Stim,v_mvc,Feat)
simp_tipple$Occ_Dropped_mvc<-simp_tipple$Occ_Dropped_mvc
simp_tipple<-simp_tipple%>%pivot_longer(cols=c('Occ_mvc','Occ_Dropped_mvc'),                                                                                                           names_to='Occ_Type', values_to='MAV')
simp_tipple<-simp_tipple%>%mutate(Occ_Type=recode(Occ_Type,
'Occ_mvc' = 'Occlusion',
'Occ_Dropped_mvc' = 'Dropped Frames-Based Occlusion'))
simp_tipple<-filter(simp_tipple, Occ_Type == 'Occlusion')
p1<-ggplot(simp_tipple, aes(x =  MVC_Voli , y = MAV , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
#facet_wrap(~Occ_Type)+
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Occlusion (% Effort)",
subtitle = "                                                                         (b)                                       ")+
scale_color_hue(labels=c('10% Stim', '20% Stim', '30% Stim'),name="Stimulated Effort")+
theme(legend.position = c(0.1, 0.17))
#pdf("conf1_ver2.pdf")
suppressWarnings(print(p1/p2))
#dev.off()
#m1 <- lm(MAV ~ (MVC_Voli + MVC_Stim), data = filter(simp_tipple, Occ_Type=='Force-Based Occlusion'))
#tidy(m1,conf.int = TRUE ,conf.level =0.95) %>% knitr::kable(digits = 3)
#m2<- lm(MAV ~ (MVC_Voli + MVC_Stim), data = filter(simp_tipple, Occ_Type=='Dropped Frames-Based Occlusion'))
#tidy(m2,conf.int = TRUE ,conf.level =0.95) %>% knitr::kable(digits = 3)
plot_tibble<-filter(occ, MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt')
ggplot(plot_tibble, aes(x = MVC_Stim_Cat , y =  MVC_Voli_Cat, fill = Occ_mvc)) +
geom_tile() +
geom_smooth(method = "lm")+
facet_wrap(~Feat)
plot_tibble<-filter(occ,MVC_Stim_Cat!="Stim_0",Tau=="3*tau",Filt=='Unfilt',Feat=='MAV')
g1<-ggplot(plot_tibble, aes(x =  MVC_Voli, y = Occ_mvc, color = MVC_Stim_Cat))+
geom_point()+
geom_smooth(method = "lm")+
facet_wrap(~Test)
g2<-ggplot(plot_tibble, aes(x =  MVC_Voli, y = Occ_Dropped_mvc, color = MVC_Stim_Cat))+
geom_point()+
geom_smooth(method = "lm")+
facet_wrap(~Test)
g3<-ggplot(plot_tibble, aes(x =  MVC_Voli, y = Occ_Hybrid_mvc, color = MVC_Stim_Cat))+
geom_point()+
geom_smooth(method = "lm")+
facet_wrap(~Test)
g1/g2/g3
filter(plot_tibble,Test=="oct18"  )%>% group_by(MVC_Stim_Cat)%>%summarise(count = n(),v_mvc)%>% arrange(desc(count))
filt="GS"
type="Occ_mvc"
Log=TRUE
coef_filt<-filter(coef, MVC_Stim_Cat!="Stim_0" &Type==type & Log==Log )
g1<-ggplot(coef_filt, aes(x = MVC_Voli, y = Effort_o-Occ,  color = MVC_Stim_Cat))+
geom_point()+
geom_smooth(method = "lm")+
facet_wrap(~Test)
g2<-ggplot(coef_filt, aes(x =  MVC_Voli, y = Occ, color = MVC_Stim_Cat))+
geom_point()+
geom_smooth(method = "lm")+
facet_wrap(~Test)
g3<-ggplot(coef_filt, aes(x =  MVC_Voli, y = Occ, color = MVC_Stim_Cat))+
geom_point()+
geom_smooth(method = "lm")+
facet_wrap(~Test)
g1/g2/g3
filter(plot_tibble,Test=="oct18"  )%>% group_by(MVC_Stim_Cat)%>%summarise(count = n(),v_mvc)%>% arrange(desc(count))
plotibble<-filter(droppedocc, NumofDropped !='4_Drops', MAV_Type !='OccHybrid', MAV_Type !='Comb',EffortType=="Hand")
formula <- y ~ poly(x, 1, raw = TRUE)
my.format <-"b[0]~`=`~%.3g*\", \"*b[1]~`=`~%.3g"
p1<-ggplot(plotibble, aes(x =  MVC_Voli , y = MAV, color = MAV_Type))+
geom_point() +
geom_smooth(method = "lm",level=0.90)+
#geom_segment(aes(x = 10, y = 10, xend = 40, yend = 40, color='No Occlusion Level'))+
facet_wrap(~MVC_Stim_Cat)
suppressWarnings(print(p1))
#lm_tibble<-filter(plotibble, MAV_Type =='Dropped')
m1 <- lm(100*MAV ~ MVC_Voli+MVC_Stim+MAV_Type, data = plotibble)
tidy(m1,conf.int = TRUE ,conf.level =0.95) %>% knitr::kable(digits = 3)
View(droppedocc)
View(droppedocc)
filt="GS"
occ_type="Occ_mvc"
log_model=FALSE
occ_err<-filter(err, MVC_Stim_Cat!="Stim_0",Filt==filt, Occ_Type==occ_type, LogModel==log_model)
occ_err1<-filter(err, MVC_Stim_Cat!="Stim_0", Occ_Type==occ_type, LogModel==log_model)
p1<-ggplot(occ_err, aes(x =  VoliMVC , y = Effort_e_MAV_err , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "Effort Estimation Error before Occlusion Correction",
subtitle = sprintf('%s filtered, %d able body participants',filt,length(unique(occ_err$Test))))
p2<-ggplot(occ_err, aes(x =  VoliMVC , y = Effort_MAV_err , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "Effort Estimation Error after Occlusion Correction",
subtitle = sprintf('%s filtered, %d able body participants',filt,length(unique(occ_err$Test))))
p3<-ggplot(occ_err1, aes(x =  VoliMVC , y = Effort_MAV_err , color = Filt)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "",
subtitle = " Comparing Different Filters")
p1/p2 -p3
p2<-ggplot(long_tibble, aes(x =  Test , y = Error_Val , color = Error_Names)) +
geom_boxplot(notch = FALSE) +
facet_wrap(   ~ Occlusion_Names)+
ylim(-100, 40)+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "Effort Estimation Error BEFORE Occlusion Correction",
subtitle = sprintf(' %s filtered, Log:%s', filt,log_model))
p1<-ggplot(filter(long_tibble,EffortType==effort_type, Error_Names!='Individualized_Correction'), aes(x =  VoliMVC , y = Error_Val , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 9, y = 0, xend = 41, yend = 0, color='Zero Error'))+
facet_wrap( Error_Names  ~  Occlusion_Names)+
# ylim(-20, 20)+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "Effort Estimation Error BEFORE Occlusion Correction",
subtitle = sprintf(' %s filtered, Log:%s, %s experiments', filt,log_model, effort_type))
long_tibble<-occ_err%>%pivot_longer(cols=c('Effort_e_MAV','Effort_MAV','Effort_MAV_Indv'),
names_to='Corrected_Efforts', values_to='Effort_Val')%>%
pivot_longer(cols=c('Effort_e_MAV_err','Effort_MAV_err','Effort_MAV_Indv_err'),
names_to='Corrected_Errors', values_to='Error_Val')
long_tibble <- long_tibble %>%
mutate(Error_Names = relevel(factor(Error_Names), ref = "Before_Correction"))
p2<-ggplot(occ_err, aes(x =  VoliMVC , y = Effort_MAV_err , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "Effort Estimation Error after Occlusion Correction",
subtitle = sprintf('%s filtered, %d able body participants',filt,length(unique(occ_err$Test))))
occ_type="Occ_mvc"
log_model=FALSE
occ_err<-filter(err, MVC_Stim_Cat!="Stim_0",Filt==filt, Occ_Type==occ_type, LogModel==log_model)
occ_err1<-filter(err, MVC_Stim_Cat!="Stim_0", Occ_Type==occ_type, LogModel==log_model)
p1<-ggplot(occ_err, aes(x =  VoliMVC , y = Effort_e_MAV_err , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "Effort Estimation Error before Occlusion Correction",
subtitle = sprintf('%s filtered, %d able body participants',filt,length(unique(occ_err$Test))))
p2<-ggplot(occ_err, aes(x =  VoliMVC , y = Effort_MAV_err , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "Effort Estimation Error after Occlusion Correction",
subtitle = sprintf('%s filtered, %d able body participants',filt,length(unique(occ_err$Test))))
p3<-ggplot(occ_err1, aes(x =  VoliMVC , y = Effort_MAV_err , color = Filt)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "",
subtitle = " Comparing Different Filters")
p1/p2 -p3
p3<-ggplot(occ_err1, aes(x =  VoliMVC , y = Effort_MAV_err , color = Filt)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-100, 40)+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "",
subtitle = " Comparing Different Filters")
p1/p2 -p3
p3<-ggplot(occ_err1, aes(x =  VoliMVC , y = Effort_MAV_err , color = Filt)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-100, 40)
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "",
subtitle = " Comparing Different Filters")
p1<-ggplot(occ_err, aes(x =  VoliMVC , y = Effort_e_MAV_err , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "Effort Estimation Error before Occlusion Correction",
subtitle = sprintf('%s filtered, %d able body participants',filt,length(unique(occ_err$Test))))
filt="GS"
occ_type="Occ_mvc"
log_model=FALSE
occ_err<-filter(err, MVC_Stim_Cat!="Stim_0",Filt==filt, Occ_Type==occ_type, LogModel==log_model)
occ_err1<-filter(err, MVC_Stim_Cat!="Stim_0", Occ_Type==occ_type, LogModel==log_model)
p1<-ggplot(occ_err, aes(x =  VoliMVC , y = Effort_e_MAV_err , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "Effort Estimation Error before Occlusion Correction",
subtitle = sprintf('%s filtered, %d able body participants',filt,length(unique(occ_err$Test))))
p2<-ggplot(occ_err, aes(x =  VoliMVC , y = Effort_MAV_err , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "Effort Estimation Error after Occlusion Correction",
subtitle = sprintf('%s filtered, %d able body participants',filt,length(unique(occ_err$Test))))
p3<-ggplot(occ_err1, aes(x =  VoliMVC , y = Effort_MAV_err , color = Filt)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-100, 40)
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "",
subtitle = " Comparing Different Filters")
p1/p2 -p3
p3<-ggplot(occ_err1, aes(x =  VoliMVC , y = Effort_MAV_err , color = Filt)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-100, 40)
labs(x = "Volitional Effort: F_v (% MVC)",
y = "Effort Estimation Error (% MVC)",
title = "",
subtitle = " Comparing Different Filters")
p1/p2 -p3
p1/p2 -p3
```{r Individualized vs Avg occ errors}
