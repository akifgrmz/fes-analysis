\\multicolumn{6}{l}{\\textbf{Force Experiment}}\\\\
%s
\\addlinespace[0.3em]
\\multicolumn{6}{l}{\\textbf{Hand Experiment}}\\\\
%s
\\bottomrule
\\multicolumn{6}{l}{\\rule{0pt}{1em}\\textit{Note:} *** p < 0.001, ** p < 0.01, * p < 0.05}\\\\
\\end{tabular}}
\\end{table}",
force_rows,
hand_rows
)
return(latex_table)
}
# Generate and print the table
latex_output <- create_tukey_table(force_data, hand_data)
cat(latex_output)
# Save to file
writeLines(latex_output, "tukey_occ_error_table.tex")
# Alternative: If you just want the main effect of Occ_Error_Type (not interaction)
tukey_main <- as.data.frame(tukey_results$Occ_Error_Type)
tukey_main$Comparison <- rownames(tukey_main)
tukey_main_processed <- tukey_main %>%
mutate(
Comparison = case_when(
Comparison == "Occ_Dropped_mvc-Effort_e_Amp_err" ~ "Dropped Frames-Uncorrected",
Comparison == "Occ_mvc-Effort_e_Amp_err" ~ "Force Corrected-Uncorrected",
Comparison == "Occ_mvc-Occ_Dropped_mvc" ~ "Force Corrected-Dropped Frames",
TRUE ~ Comparison
),
diff = round(diff, 4),
lwr = round(lwr, 4),
upr = round(upr, 4),
`p adj` = round(`p adj`, 7),
Sig = case_when(
`p adj` < 0.001 ~ "***",
`p adj` < 0.01 ~ "**",
`p adj` < 0.05 ~ "*",
TRUE ~ ""
)
) %>%
select(Comparison, diff, lwr, upr, `p adj`, Sig)
# Print simple main effect table
print(tukey_main_processed)
library(broom)
library(dplyr)
library(knitr)
library(kableExtra)
# Run ANOVA
model <- aov(Error ~ EffortType * Occ_Error_Type, data = occ_err_long1)
# Tidy ANOVA results
tidy_results <- tidy(model) %>%
mutate(across(where(is.numeric), ~round(., 4))) %>%
select(term, df, sumsq, meansq, statistic, p.value)
# Print ANOVA table
print(tidy_results)
# Tukey HSD post-hoc test
tukey_results <- TukeyHSD(model)
# Extract Occ_Error_Type comparisons
tukey_occ <- as.data.frame(tukey_results$Occ_Error_Type)
tukey_occ$Comparison <- rownames(tukey_occ)
# Filter for only the three specific comparisons
tukey_occ_filtered <- tukey_occ %>%
filter(Comparison %in% c("Occ_Dropped_mvc-Effort_e_Amp_err",
"Occ_mvc-Effort_e_Amp_err",
"Occ_mvc-Occ_Dropped_mvc")) %>%
select(Comparison, diff, lwr, upr, `p adj`) %>%
mutate(
Comparison = case_when(
Comparison == "Occ_Dropped_mvc-Effort_e_Amp_err" ~ "Dropped Frames - Uncorrected",
Comparison == "Occ_mvc-Effort_e_Amp_err" ~ "Force Corrected - Uncorrected",
Comparison == "Occ_mvc-Occ_Dropped_mvc" ~ "Force Corrected - Dropped Frames",
TRUE ~ Comparison
),
across(c(diff, lwr, upr), ~formatC(., format = "e", digits = 2)),
`p adj` = formatC(`p adj`, format = "f", digits = 7),
Sig = case_when(
as.numeric(`p adj`) < 0.001 ~ "***",
as.numeric(`p adj`) < 0.01 ~ "**",
as.numeric(`p adj`) < 0.05 ~ "*",
TRUE ~ "ns"
)
)
# Create LaTeX table without cellcolor
tukey_latex <- tukey_occ_filtered %>%
kable(format = "latex",
booktabs = TRUE,
caption = "Tukey HSD Post-hoc Comparisons for Occlusion Correction Methods",
col.names = c("Comparison", "Difference", "Lower CI", "Upper CI", "Adj. p-value", "Sig."),
align = c("l", "r", "r", "r", "r", "c"),
escape = FALSE,
linesep = "") %>%
kable_styling(latex_options = c("hold_position"),
font_size = 10) %>%
footnote(general = "*** p < 0.001, ** p < 0.01, * p < 0.05, ns = not significant",
general_title = "Note:",
footnote_as_chunk = TRUE,
escape = FALSE)
cat(tukey_latex)
writeLines(tukey_latex, "tukey_table.tex")
library(broom)
library(dplyr)
library(knitr)
library(kableExtra)
# Run ANOVA
model <- aov(Error ~ EffortType * Occ_Error_Type, data = occ_err_long1)
# Tidy ANOVA results
tidy_results <- tidy(model) %>%
mutate(across(where(is.numeric), ~round(., 4))) %>%
select(term, df, sumsq, meansq, statistic, p.value)
# Print ANOVA table
print(tidy_results)
# Tukey HSD post-hoc test
tukey_results <- TukeyHSD(model)
# Extract Occ_Error_Type comparisons
tukey_occ <- as.data.frame(tukey_results$Occ_Error_Type)
tukey_occ$Comparison <- rownames(tukey_occ)
# Filter for only the three specific comparisons
tukey_occ_filtered <- tukey_occ %>%
filter(Comparison %in% c("Occ_Dropped_mvc-Effort_e_Amp_err",
"Occ_mvc-Effort_e_Amp_err",
"Occ_mvc-Occ_Dropped_mvc")) %>%
select(Comparison, diff, lwr, upr, `p adj`) %>%
mutate(
Comparison = case_when(
Comparison == "Occ_Dropped_mvc-Effort_e_Amp_err" ~ "Dropped Frames - Uncorrected",
Comparison == "Occ_mvc-Effort_e_Amp_err" ~ "Force Corrected - Uncorrected",
Comparison == "Occ_mvc-Occ_Dropped_mvc" ~ "Force Corrected - Dropped Frames",
TRUE ~ Comparison
),
across(c(diff, lwr, upr), ~formatC(., format = "e", digits = 2)),
`p adj` = formatC(`p adj`, format = "f", digits = 7),
Sig = case_when(
as.numeric(`p adj`) < 0.001 ~ "***",
as.numeric(`p adj`) < 0.01 ~ "**",
as.numeric(`p adj`) < 0.05 ~ "*",
TRUE ~ "ns"
)
)
# Create LaTeX table without cellcolor
tukey_latex <- tukey_occ_filtered %>%
kable(format = "latex",
booktabs = TRUE,
caption = "Tukey HSD Post-hoc Comparisons for Occlusion Correction Methods",
col.names = c("Comparison", "Difference", "Lower CI", "Upper CI", "Adj. p-value", "Sig."),
align = c("l", "r", "r", "r", "r", "c"),
escape = FALSE,
linesep = "") %>%
kable_styling(latex_options = c("hold_position"),
font_size = 10) %>%
footnote(general = "*** p < 0.001, ** p < 0.01, * p < 0.05, ns = not significant",
general_title = "Note:",
footnote_as_chunk = TRUE,
escape = FALSE)
# Save to file
writeLines(tukey_latex, "tukey_table.tex")
# Alternative: Save to a specific directory
writeLines(tukey_latex, "path/to/your/directory/tukey_table.tex")
library(broom)
library(dplyr)
library(knitr)
library(kableExtra)
# Run ANOVA
model <- aov(Error ~ EffortType * Occ_Error_Type, data = occ_err_long1)
# Tidy ANOVA results
tidy_results <- tidy(model) %>%
mutate(across(where(is.numeric), ~round(., 4))) %>%
select(term, df, sumsq, meansq, statistic, p.value)
# Print ANOVA table
print(tidy_results)
# Tukey HSD post-hoc test
tukey_results <- TukeyHSD(model)
# Extract Occ_Error_Type comparisons
tukey_occ <- as.data.frame(tukey_results$Occ_Error_Type)
tukey_occ$Comparison <- rownames(tukey_occ)
# Filter for only the three specific comparisons
tukey_occ_filtered <- tukey_occ %>%
filter(Comparison %in% c("Occ_Dropped_mvc-Effort_e_Amp_err",
"Occ_mvc-Effort_e_Amp_err",
"Occ_mvc-Occ_Dropped_mvc")) %>%
select(Comparison, diff, lwr, upr, `p adj`) %>%
mutate(
Comparison = case_when(
Comparison == "Occ_Dropped_mvc-Effort_e_Amp_err" ~ "Dropped Frames - Uncorrected",
Comparison == "Occ_mvc-Effort_e_Amp_err" ~ "Force Corrected - Uncorrected",
Comparison == "Occ_mvc-Occ_Dropped_mvc" ~ "Force Corrected - Dropped Frames",
TRUE ~ Comparison
),
across(c(diff, lwr, upr), ~formatC(., format = "e", digits = 2)),
`p adj` = formatC(`p adj`, format = "f", digits = 7),
Sig = case_when(
as.numeric(`p adj`) < 0.001 ~ "***",
as.numeric(`p adj`) < 0.01 ~ "**",
as.numeric(`p adj`) < 0.05 ~ "*",
TRUE ~ "ns"
)
)
# Create LaTeX table without cellcolor
tukey_latex <- tukey_occ_filtered %>%
kable(format = "latex",
booktabs = TRUE,
caption = "Tukey HSD Post-hoc Comparisons for Occlusion Correction Methods",
col.names = c("Comparison", "Difference", "Lower CI", "Upper CI", "Adj. p-value", "Sig."),
align = c("l", "r", "r", "r", "r", "c"),
escape = FALSE,
linesep = "") %>%
kable_styling(latex_options = c("hold_position"),
font_size = 10) %>%
footnote(general = "*** p < 0.001, ** p < 0.01, * p < 0.05, ns = not significant",
general_title = "Note:",
footnote_as_chunk = TRUE,
escape = FALSE)
# Save to file
writeLines(tukey_latex, "tukey_table.tex")
# Alternative: Save to a specific directory
# writeLines(tukey_latex, "path/to/your/directory/tukey_table.tex")
# Or save multiple tables to one file
sink("all_tables.tex")
cat(tukey_latex)
sink()
# Print to console as well
cat(tukey_latex)
writeLines(tukey_latex, "tukey_table.tex")
library(broom)
library(dplyr)
library(knitr)
library(kableExtra)
# Run separate ANOVAs for Force and Hand
occ_err_force <- occ_err_long1 %>% filter(EffortType == "Force")
occ_err_hand <- occ_err_long1 %>% filter(EffortType == "Hand")
model_force <- aov(Error ~ Occ_Error_Type, data = occ_err_force)
model_hand <- aov(Error ~ Occ_Error_Type, data = occ_err_hand)
# Tidy ANOVA results
tidy_force <- tidy(model_force) %>%
mutate(across(where(is.numeric), ~round(., 4))) %>%
select(term, df, sumsq, meansq, statistic, p.value) %>%
mutate(Experiment = "Force")
tidy_hand <- tidy(model_hand) %>%
mutate(across(where(is.numeric), ~round(., 4))) %>%
select(term, df, sumsq, meansq, statistic, p.value) %>%
mutate(Experiment = "Hand")
# Print ANOVA tables
print("Force Experiment ANOVA:")
print(tidy_force)
print("\nHand Experiment ANOVA:")
print(tidy_hand)
# Tukey HSD post-hoc tests
tukey_force <- TukeyHSD(model_force)
tukey_hand <- TukeyHSD(model_hand)
# Extract and process Force comparisons
tukey_force_df <- as.data.frame(tukey_force$Occ_Error_Type)
tukey_force_df$Comparison <- rownames(tukey_force_df)
tukey_force_filtered <- tukey_force_df %>%
filter(Comparison %in% c("Occ_Dropped_mvc-Effort_e_Amp_err",
"Occ_mvc-Effort_e_Amp_err",
"Occ_mvc-Occ_Dropped_mvc")) %>%
select(Comparison, diff, lwr, upr, `p adj`) %>%
mutate(
Comparison = case_when(
Comparison == "Occ_Dropped_mvc-Effort_e_Amp_err" ~ "Dropped Frames - Uncorrected",
Comparison == "Occ_mvc-Effort_e_Amp_err" ~ "Force Corrected - Uncorrected",
Comparison == "Occ_mvc-Occ_Dropped_mvc" ~ "Force Corrected - Dropped Frames",
TRUE ~ Comparison
),
across(c(diff, lwr, upr), ~formatC(., format = "e", digits = 2)),
`p adj` = formatC(`p adj`, format = "f", digits = 7),
Sig = case_when(
as.numeric(`p adj`) < 0.001 ~ "***",
as.numeric(`p adj`) < 0.01 ~ "**",
as.numeric(`p adj`) < 0.05 ~ "*",
TRUE ~ "ns"
)
)
# Extract and process Hand comparisons
tukey_hand_df <- as.data.frame(tukey_hand$Occ_Error_Type)
tukey_hand_df$Comparison <- rownames(tukey_hand_df)
tukey_hand_filtered <- tukey_hand_df %>%
filter(Comparison %in% c("Occ_Dropped_mvc-Effort_e_Amp_err",
"Occ_mvc-Effort_e_Amp_err",
"Occ_mvc-Occ_Dropped_mvc")) %>%
select(Comparison, diff, lwr, upr, `p adj`) %>%
mutate(
Comparison = case_when(
Comparison == "Occ_Dropped_mvc-Effort_e_Amp_err" ~ "Dropped Frames - Uncorrected",
Comparison == "Occ_mvc-Effort_e_Amp_err" ~ "Force Corrected - Uncorrected",
Comparison == "Occ_mvc-Occ_Dropped_mvc" ~ "Force Corrected - Dropped Frames",
TRUE ~ Comparison
),
across(c(diff, lwr, upr), ~formatC(., format = "e", digits = 2)),
`p adj` = formatC(`p adj`, format = "f", digits = 7),
Sig = case_when(
as.numeric(`p adj`) < 0.001 ~ "***",
as.numeric(`p adj`) < 0.01 ~ "**",
as.numeric(`p adj`) < 0.05 ~ "*",
TRUE ~ "ns"
)
)
# Create combined table
tukey_combined <- bind_rows(
tukey_force_filtered %>% mutate(Experiment = "Force"),
tukey_hand_filtered %>% mutate(Experiment = "Hand")
) %>%
select(Experiment, everything())
# Create LaTeX table for Force experiment
tukey_latex_force <- tukey_force_filtered %>%
kable(format = "latex",
booktabs = TRUE,
caption = "Tukey HSD Post-hoc Comparisons for Force Experiment",
col.names = c("Comparison", "Difference", "Lower CI", "Upper CI", "Adj. p-value", "Sig."),
align = c("l", "r", "r", "r", "r", "c"),
escape = FALSE,
linesep = "") %>%
kable_styling(latex_options = c("hold_position"),
font_size = 10) %>%
footnote(general = "*** p < 0.001, ** p < 0.01, * p < 0.05, ns = not significant",
general_title = "Note:",
footnote_as_chunk = TRUE,
escape = FALSE)
# Create LaTeX table for Hand experiment
tukey_latex_hand <- tukey_hand_filtered %>%
kable(format = "latex",
booktabs = TRUE,
caption = "Tukey HSD Post-hoc Comparisons for Hand Experiment",
col.names = c("Comparison", "Difference", "Lower CI", "Upper CI", "Adj. p-value", "Sig."),
align = c("l", "r", "r", "r", "r", "c"),
escape = FALSE,
linesep = "") %>%
kable_styling(latex_options = c("hold_position"),
font_size = 10) %>%
footnote(general = "*** p < 0.001, ** p < 0.01, * p < 0.05, ns = not significant",
general_title = "Note:",
footnote_as_chunk = TRUE,
escape = FALSE)
# Create combined LaTeX table
tukey_latex_combined <- tukey_combined %>%
kable(format = "latex",
booktabs = TRUE,
caption = "Tukey HSD Post-hoc Comparisons for Force and Hand Experiments",
col.names = c("Experiment", "Comparison", "Difference", "Lower CI", "Upper CI", "Adj. p-value", "Sig."),
align = c("l", "l", "r", "r", "r", "r", "c"),
escape = FALSE,
linesep = "") %>%
kable_styling(latex_options = c("hold_position"),
font_size = 9) %>%
collapse_rows(columns = 1, latex_hline = "major", valign = "top") %>%
footnote(general = "*** p < 0.001, ** p < 0.01, * p < 0.05, ns = not significant",
general_title = "Note:",
footnote_as_chunk = TRUE,
escape = FALSE)
# Print tables
cat("\nForce Experiment Table:\n")
cat(tukey_latex_force)
cat("\n\nHand Experiment Table:\n")
cat(tukey_latex_hand)
cat("\n\nCombined Table:\n")
cat(tukey_latex_combined)
# Save to files
writeLines(tukey_latex_force, "tukey_force.tex")
writeLines(tukey_latex_hand, "tukey_hand.tex")
writeLines(tukey_latex_combined, "tukey_combined.tex")
# Save all to one file
sink("tukey_all_results.tex")
cat("% Force Experiment\n")
cat(tukey_latex_force)
cat("\n\n% Hand Experiment\n")
cat(tukey_latex_hand)
cat("\n\n% Combined Results\n")
cat(tukey_latex_combined)
sink()
# Print summary statistics
cat("\n\nSummary Statistics:\n")
summary_stats <- occ_err_long1 %>%
group_by(EffortType, Occ_Error_Type) %>%
summarise(
Mean = mean(Error, na.rm = TRUE),
SD = sd(Error, na.rm = TRUE),
N = n(),
.groups = "drop"
) %>%
mutate(
Occ_Error_Type = case_when(
Occ_Error_Type == "Effort_e_Amp_err" ~ "Uncorrected",
Occ_Error_Type == "Occ_Dropped_mvc" ~ "Dropped Frames",
Occ_Error_Type == "Occ_mvc" ~ "Force Corrected",
TRUE ~ Occ_Error_Type
)
)
print(summary_stats)
library(broom)
library(dplyr)
library(knitr)
library(kableExtra)
# Run separate ANOVAs for Force and Hand
occ_err_force <- occ_err_long1 %>% filter(EffortType == "Force")
occ_err_hand <- occ_err_long1 %>% filter(EffortType == "Hand")
model_force <- aov(Error ~ Occ_Error_Type, data = occ_err_force)
model_hand <- aov(Error ~ Occ_Error_Type, data = occ_err_hand)
# Tukey HSD post-hoc tests
tukey_force <- TukeyHSD(model_force)
tukey_hand <- TukeyHSD(model_hand)
# Extract and process Force comparisons
tukey_force_df <- as.data.frame(tukey_force$Occ_Error_Type)
tukey_force_df$Comparison <- rownames(tukey_force_df)
tukey_force_filtered <- tukey_force_df %>%
filter(Comparison %in% c("Occ_Dropped_mvc-Effort_e_Amp_err",
"Occ_mvc-Effort_e_Amp_err",
"Occ_mvc-Occ_Dropped_mvc")) %>%
select(Comparison, diff, lwr, upr, `p adj`) %>%
mutate(
Comparison = case_when(
Comparison == "Occ_Dropped_mvc-Effort_e_Amp_err" ~ "Dropped Frames-Uncorrected",
Comparison == "Occ_mvc-Effort_e_Amp_err" ~ "Force Corrected-Uncorrected",
Comparison == "Occ_mvc-Occ_Dropped_mvc" ~ "Force Corrected-Dropped Frames",
TRUE ~ Comparison
),
Difference = formatC(diff, format = "e", digits = 1),
`Lower CI` = formatC(lwr, format = "e", digits = 1),
`Upper CI` = formatC(upr, format = "e", digits = 1),
`Adj. p-value` = formatC(`p adj`, format = "f", digits = 6),
Sig. = case_when(
`p adj` < 0.001 ~ "***",
`p adj` < 0.01 ~ "**",
`p adj` < 0.05 ~ "*",
TRUE ~ "ns"
)
) %>%
select(Comparison, Difference, `Lower CI`, `Upper CI`, `Adj. p-value`, Sig.)
# Extract and process Hand comparisons
tukey_hand_df <- as.data.frame(tukey_hand$Occ_Error_Type)
tukey_hand_df$Comparison <- rownames(tukey_hand_df)
tukey_hand_filtered <- tukey_hand_df %>%
filter(Comparison %in% c("Occ_Dropped_mvc-Effort_e_Amp_err",
"Occ_mvc-Effort_e_Amp_err",
"Occ_mvc-Occ_Dropped_mvc")) %>%
select(Comparison, diff, lwr, upr, `p adj`) %>%
mutate(
Comparison = case_when(
Comparison == "Occ_Dropped_mvc-Effort_e_Amp_err" ~ "Dropped Frames-Uncorrected",
Comparison == "Occ_mvc-Effort_e_Amp_err" ~ "Force Corrected-Uncorrected",
Comparison == "Occ_mvc-Occ_Dropped_mvc" ~ "Force Corrected-Dropped Frames",
TRUE ~ Comparison
),
Difference = formatC(diff, format = "e", digits = 1),
`Lower CI` = formatC(lwr, format = "e", digits = 1),
`Upper CI` = formatC(upr, format = "e", digits = 1),
`Adj. p-value` = formatC(`p adj`, format = "f", digits = 6),
Sig. = case_when(
`p adj` < 0.001 ~ "***",
`p adj` < 0.01 ~ "**",
`p adj` < 0.05 ~ "*",
TRUE ~ "ns"
)
) %>%
select(Comparison, Difference, `Lower CI`, `Upper CI`, `Adj. p-value`, Sig.)
# Add experiment labels
tukey_force_final <- tukey_force_filtered %>%
mutate(Experiment = "Force Experiment") %>%
select(Experiment, everything())
tukey_hand_final <- tukey_hand_filtered %>%
mutate(Experiment = "Hand Experiment") %>%
select(Experiment, everything())
# Combine both experiments
tukey_combined <- bind_rows(tukey_force_final, tukey_hand_final)
# Create LaTeX table in the style of the reference
tukey_latex <- tukey_combined %>%
kable(format = "latex",
booktabs = TRUE,
caption = "TUKEY HSD POST-HOC COMPARISONS FOR OCCLUSION CORRECTION METHODS",
col.names = c("", "Comparison", "Difference", "Lower CI", "Upper CI", "Adj. p-value", "Sig."),
align = c("l", "l", "r", "r", "r", "r", "c"),
escape = FALSE,
linesep = c("", "", "\\addlinespace")) %>%
kable_styling(latex_options = c("hold_position"),
font_size = 10,
position = "center") %>%
pack_rows("Force Experiment", 1, 3, latex_gap_space = "0.5em", bold = FALSE, italic = TRUE) %>%
pack_rows("Hand Experiment", 4, 6, latex_gap_space = "0.5em", bold = FALSE, italic = TRUE) %>%
footnote(general = "*** p < 0.001, ** p < 0.01, * p < 0.05",
general_title = "Note:",
footnote_as_chunk = TRUE,
escape = FALSE)
# Alternative: Remove the Experiment column and use row grouping only
tukey_latex_alt <- bind_rows(
tukey_force_filtered,
tukey_hand_filtered
) %>%
kable(format = "latex",
booktabs = TRUE,
caption = "TUKEY HSD POST-HOC COMPARISONS FOR OCCLUSION CORRECTION METHODS",
col.names = c("", "Difference", "Lower CI", "Upper CI", "Adj. p-value", "Sig."),
align = c("l", "r", "r", "r", "r", "c"),
escape = FALSE,
linesep = c("", "", "\\addlinespace")) %>%
kable_styling(latex_options = c("hold_position"),
font_size = 10,
position = "center") %>%
pack_rows("Force Experiment", 1, 3, latex_gap_space = "0.5em", bold = FALSE, italic = TRUE) %>%
pack_rows("Hand Experiment", 4, 6, latex_gap_space = "0.5em", bold = FALSE, italic = TRUE) %>%
footnote(general = "*** p < 0.001, ** p < 0.01, * p < 0.05",
general_title = "Note:",
footnote_as_chunk = TRUE,
escape = FALSE)
# Print tables
cat("\nCombined Table with Experiment Column:\n")
cat(tukey_latex)
cat("\n\nCombined Table with Row Grouping:\n")
cat(tukey_latex_alt)
# Save to files
writeLines(tukey_latex, "tukey_occlusion_combined.tex")
writeLines(tukey_latex_alt, "tukey_occlusion_grouped.tex")
# Print to console
print(tukey_combined)
