title = "Comparing Dropped Frames using BoxPlots",
subtitle = SubTitleString)+
ylim(0,4)
tests <- c('mar7','mar16')
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt |Filt_Type=='Dropped' )
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Test==tests & Repeat=="Rep_1" & Filt_Type==c("Unfilt")), aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1/35000, xend = 525, yend = 1/35000, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01/35000, xend = 525, yend = 4/35000, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,0.0002)
#pdf("figures/4dropped3.pdf")
#dev.off()
tests <- c('mar7','mar16')
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt |Filt_Type=='Dropped' )
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Test==tests& Filt_Type==c("Unfilt")), aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1/35000, xend = 525, yend = 1/35000, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01/35000, xend = 525, yend = 4/35000, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,0.0002)
#pdf("figures/4dropped3.pdf")
#dev.off()
tests <- c("mar16","mar7")
filt='GS'
reps=c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
median_cl_boot <- function(x, conf = 0.95) {
lconf <- (1 - conf)/2
uconf <- 1 - lconf
require(boot)
bmedian <- function(x, ind) median(x[ind])
bt <- boot(x, bmedian, 1000)
bb <- boot.ci(bt, type = "perc")
data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t,
uconf))
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s |  Filter for NonDropped: %s | 350<=Frames<=525" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests & Repeat==reps & Frame <= 525 &  Frame >= 350 & Filt_Type==filt | Filt_Type=='Dropped' )
ggplot(data = plot_df, aes(x = Drp_Order , y = Norm_Val, color = Drp_Order)) +
geom_boxplot(notch = TRUE) +
#geom_segment(aes(x = "NonDropped", y = 1, xend = "4th_Dropped", yend = 1,  color='Avg. 0-Stim Level'))+
#geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
stat_summary(fun.data = mean_cl_boot, geom = "errorbar") +
stat_summary(fun.y = mean, geom = "point")+
#stat_summary(fun.data = median_cl_boot, geom = "errorbar",
#colour = "red") + stat_summary(fun.y = median, geom = "point", colour = "red")
labs(x = "Frames",
y = "Normalized MAV",
title = "Comparing Dropped Frames using BoxPlots",
subtitle = SubTitleString)+
ylim(0,4)
View(plot_df)
tests <- c("mar7","mar16")
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt | Filt_Type=='Dropped' )
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Test==tests& Filt_Type==c("Unfilt")), aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1/35000, xend = 525, yend = 1/35000, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01/35000, xend = 525, yend = 4/35000, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,0.0002)
#pdf("figures/4dropped3.pdf")
#dev.off()
tests <- c("mar7","mar16")
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt  )
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Test==tests& Filt_Type==c("Unfilt")), aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1/35000, xend = 525, yend = 1/35000, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01/35000, xend = 525, yend = 4/35000, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,0.0002)
#pdf("figures/4dropped3.pdf")
#dev.off()
geom_line(data= filter(df,Filt_Type=='Dropped'  , aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
tests <- c("mar7","mar16")
filt<-c('GS')
tests <- c("mar7","mar16")
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt & Filt_Type==c("Unfilt")))
tests <- c("mar7","mar16")
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt & Filt_Type==c("Unfilt"))
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Filt_Type=='Dropped'  , aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1/35000, xend = 525, yend = 1/35000, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01/35000, xend = 525, yend = 4/35000, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,0.0002)
#pdf("figures/4dropped3.pdf")
#dev.off()
tests <- c("mar7","mar16")
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt & Filt_Type==c("Unfilt"))
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df ,Filt_Type=='Dropped'  ), aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1/35000, xend = 525, yend = 1/35000, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01/35000, xend = 525, yend = 4/35000, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,0.0002)
tests <- c("mar7","mar16")
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt & Filt_Type==c("Unfilt"))
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df ,Filt_Type=='Dropped'  ) aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
tests <- c("mar7","mar16")
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt | Filt_Type=='Dropped' )
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Test==tests & Filt_Type==c("Unfilt")), aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1/35000, xend = 525, yend = 1/35000, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01/35000, xend = 525, yend = 4/35000, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,0.0002)
#pdf("figures/4dropped3.pdf")
#dev.off()
tests <- c("mar7","mar16")
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt & Filt_Type=='Dropped' )
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Test==tests & Filt_Type==c("Unfilt")), aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1/35000, xend = 525, yend = 1/35000, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01/35000, xend = 525, yend = 4/35000, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,0.0002)
tests <- c("mar7","mar16")
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt | Filt_Type=='Dropped' )
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Test==tests & Filt_Type==c("Unfilt")), aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1/35000, xend = 525, yend = 1/35000, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01/35000, xend = 525, yend = 4/35000, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,0.0002)
#pdf("figures/4dropped3.pdf")
#dev.off()
tests <- c("mar7","mar16")
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests  & Repeat==reps & Filt_Type==filt | Filt_Type=='Dropped' )
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Test==tests & Filt_Type==c("Unfilt")), aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1/35000, xend = 525, yend = 1/35000, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01/35000, xend = 525, yend = 4/35000, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,0.0002)
#pdf("figures/4dropped3.pdf")
#dev.off()
tests <- c("mar16","mar7")
filt='GS'
reps=c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
median_cl_boot <- function(x, conf = 0.95) {
lconf <- (1 - conf)/2
uconf <- 1 - lconf
require(boot)
bmedian <- function(x, ind) median(x[ind])
bt <- boot(x, bmedian, 1000)
bb <- boot.ci(bt, type = "perc")
data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t,
uconf))
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s |  Filter for NonDropped: %s | 350<=Frames<=525" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests & Repeat==reps & Frame <= 525 &  Frame >= 350 & Filt_Type==filt | Filt_Type=='Dropped' )
ggplot(data = plot_df, aes(x = Drp_Order , y = Norm_Val, color = Drp_Order)) +
geom_boxplot(notch = TRUE) +
#geom_segment(aes(x = "NonDropped", y = 1, xend = "4th_Dropped", yend = 1,  color='Avg. 0-Stim Level'))+
#geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
stat_summary(fun.data = mean_cl_boot, geom = "errorbar") +
stat_summary(fun.y = mean, geom = "point")+
#stat_summary(fun.data = median_cl_boot, geom = "errorbar",
#colour = "red") + stat_summary(fun.y = median, geom = "point", colour = "red")
labs(x = "Frames",
y = "Normalized MAV",
title = "Comparing Dropped Frames using BoxPlots",
subtitle = SubTitleString)+
ylim(0,4)
View(plot_df)
tests <- c("mar7","mar16")
filt<-c('GS')
reps<-c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests)
plot_df<-filter(plot_df, Repeat==reps & Filt_Type==filt | Filt_Type=='Dropped' )
summary(plot_df)
ggplot(plot_df, aes(x = Frame, y = Frame_Val, color = Divide_Cat)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Test==tests & Filt_Type==c("Unfilt")), aes(x = Frame, y = Target*5/35000, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1/35000, xend = 525, yend = 1/35000, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01/35000, xend = 525, yend = 4/35000, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,0.0002)
#pdf("figures/4dropped3.pdf")
#dev.off()
View(plot_df)
tests <- c("mar7", "mar16",'feb27')
filt='GS'
reps=c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests )
plot_df<-filter(plot_df,  Repeat==reps & Filt_Type==filt |Filt_Type=='Dropped' )
summary(plot_df)
#pdf("figures/4dropped3.pdf")
plt<-ggplot(plot_df, aes(x = Frame, y = Norm_Val, color = Drp_Order)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Repeat=="Rep_1" & Filt_Type==c("Unfilt")), aes(x = Frame, y = Target*5, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1, xend = 525, yend = 1, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01, xend = 525, yend = 4, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "Normalized MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,2)
plt
#dev.off()
tests <- c("mar7", "mar16",'feb27')
filt='GS'
reps=c('Rep_1','Rep_2','Rep_3')
TestString<-""
for (iTest in 1:length(tests))
{
TestString<-sprintf("%s, %s",TestString, tests[iTest])
}
RepString<-""
for (iTest in 1:length(reps))
{
RepString<-sprintf("%s, %s",RepString, reps[iTest])
}
SubTitleString<-sprintf("Tests: %s | Repeats: %s | Filter: %s | Dropped Frames are not Filtered" ,TestString,RepString,filt)
plot_df<-filter(df, Test==tests )
plot_df<-filter(plot_df,  Repeat==reps & Filt_Type==filt |Filt_Type=='Dropped' )
summary(plot_df)
#pdf("figures/4dropped3.pdf")
plt<-ggplot(plot_df, aes(x = Frame, y = Norm_Val, color = Drp_Order)) +
geom_point() + #size = 1.2, alpha = 0.6
geom_line(data= filter(df,Repeat=="Rep_1" & Filt_Type==c("Unfilt")), aes(x = Frame, y = Target*5, color = "Target (a.u.)")) +
geom_segment(aes(x = 350, y = 1, xend = 525, yend = 1, color='Avg. 0-Stim Level'))+
geom_segment(aes(x = 525, y = 0.01, xend = 525, yend = 4, color='Stim Turn Off'))+
geom_smooth(method = "loess", se=F)+
facet_wrap(MVC_Stim~MVC_Voli)+
labs(x = "Frames",
y = "Normalized MAV",
title = "Droping 4 Consecutive Frames",
subtitle = SubTitleString)+
ylim(0,1)
plt
#dev.off()
