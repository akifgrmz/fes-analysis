#                                   'Occ_Dropped_mvc' = 'Dropped Frames\nBased'
#                                  ))
occ_err1<-filter(err, MVC_Stim_Cat!="Stim_0",Occ_Type=="Occ_mvc")
occ_err_long<-filter(occ_err_long, Occ_Error_Type!="Occ_Dropped_mvc")
occ_err_long <- occ_err_long %>%
mutate(Occ_Error_Type = relevel(Occ_Error_Type, ref = "Effort_e_Amp_err"))
my_labeller <- as_labeller(c(Occ_mvc="E[o]+E[e]", Effort_e_Amp_err="E[e]"),
default = label_parsed)
p1<-ggplot(occ_err_long, aes(x =  VoliMVC , y = Error , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 9, y = 0, xend = 41, yend = 0, color='Zero Error'))+
facet_wrap(~Occ_Error_Type,labeller=my_labeller)+
ylim(-50, 20)+
labs(x = expression("Volitional Effort (E"[v]*") "),
y = "Effort Estimation Error (% Effort)",
subtitle = sprintf('                                 (a)                                                                  (b)                           ',type, filt))+
scale_color_hue(labels=c('10% Stim', '20% Stim', '30% Stim','Zero Error'),name=expression("Stim. Effort (E"[s]*")"))+
theme(legend.position = c(0.6, 0.3))
p2<-ggplot(occ_err_long, aes(x =  Occ_Error_Type , y = Error,color=Occ_Error_Type )) +
geom_boxplot(notch=TRUE)+
ylim(-55, 25)+
geom_signif(comparisons = list(c("Occ_mvc","Effort_e_Amp_err")),
y_position = 15, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
subtitle = "                                 (c)  ")+
scale_color_hue(labels=c('Occlusion Corrected', 'Uncorrected', 'Force Based'),name="Correction")+
theme(legend.position = c(0.7, 0.2))
p3<-ggplot(occ_err1, aes(x =  Filt , y = Effort_Amp_err , color = Filt)) +
geom_boxplot(notch=TRUE)+
#geom_smooth(method = "lm")+
# geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-50, 50)+
geom_signif(comparisons = list(c("Comb","Unfilt")),
y_position = 40, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
geom_signif(comparisons = list(c("GS","Comb")),
y_position = 35, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black")+
geom_signif(comparisons = list(c("Unfilt","GS")),
y_position = 30, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
#title = "",
subtitle = "                              (d)")+
scale_color_hue(labels=c('Comb', 'GS', 'Unfiltered'),name="Filter")+
theme(legend.position = c(0.8, 0.2))
#pdf("conf2_ver2.pdf")
suppressWarnings(print(p1/(p2-p3)))
#dev.off()
mean_err_type<-occ_err_long %>% group_by(Occ_Error_Type)  %>% summarise( "Mean"= round(mean(Error),2), "RMS"=round(sqrt(mean(Error^2)),2),"Est"='Before Correction')
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log)%>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_Indv_err),2), "RMS"=round(sqrt(mean(Effort_Amp_Indv_err^2)),2),"Est"='Individualized Correction',"Log"=Log) )
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log) %>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_err),2), "RMS"=round(sqrt(mean(Effort_Amp_err^2)),2),"Est"='After Correction',"Log"=Log) )
filt="GS"
type='Occ_Hybrid_mvc'
Log=TRUE
occ_err<-filter(err, MVC_Stim_Cat!="Stim_0",Filt==filt, Occ_Type!=type,LogModel==Log)%>%
select(Occ_Type,Effort_Amp_err,Effort_e_Amp_err,MVC_Stim_Cat,VoliMVC)
occ_err_wide<-occ_err %>% pivot_wider(names_from = Occ_Type, values_from = Effort_Amp_err)
occ_err_long<-occ_err_wide%>%pivot_longer(cols=c('Occ_mvc','Occ_Dropped_mvc','Effort_e_Amp_err'),
names_to='Occ_Error_Type',
values_to='Error')%>%mutate(Occ_Error_Type = as.factor(Occ_Error_Type))
#%>%mutate(Occ_Error_Type=recode(
#                                     Occ_Error_Type,'Effort_e_Amp_err' = 'Uncorrected',
#                                    'Occ_mvc' = 'Occlusion Corrected',
#                                   'Occ_Dropped_mvc' = 'Dropped Frames\nBased'
#                                  ))
occ_err1<-filter(err, MVC_Stim_Cat!="Stim_0",Occ_Type=="Occ_mvc")
occ_err_long<-filter(occ_err_long, Occ_Error_Type!="Occ_Dropped_mvc")
occ_err_long <- occ_err_long %>%
mutate(Occ_Error_Type = relevel(Occ_Error_Type, ref = "Effort_e_Amp_err"))
my_labeller <- as_labeller(c(Occ_mvc="E[o]+E[e]", Effort_e_Amp_err="E[e]"),
default = label_parsed)
p1<-ggplot(occ_err_long, aes(x =  VoliMVC , y = Error , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 9, y = 0, xend = 41, yend = 0, color='Zero Error'))+
facet_wrap(~Occ_Error_Type,labeller=my_labeller)+
ylim(-50, 20)+
labs(x = expression("Volitional Effort (E"[v]*") "),
y = "Effort Estimation Error (% Effort)",
subtitle = sprintf('                                 (a)                                                                  (b)                           ',type, filt))+
scale_color_hue(labels=c('10% Stim', '20% Stim', '30% Stim','Zero Error'),name=expression("Stim. Effort (E"[s]*")"))+
theme(legend.position = c(0.6, 0.3))
p2<-ggplot(occ_err_long, aes(x =  Occ_Error_Type , y = Error,color=Occ_Error_Type )) +
geom_boxplot(notch=TRUE)+
ylim(-55, 25)+
geom_signif(comparisons = list(c("Occ_mvc","Effort_e_Amp_err")),
y_position = 15, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
subtitle = "                                 (c)  ")+
scale_color_hue(labels=c('Occlusion Corrected', 'Uncorrected', 'Force Based'),name="Correction")+
theme(legend.position = c(0.7, 0.2))
p3<-ggplot(occ_err1, aes(x =  Filt , y = Effort_Amp_err , color = Filt)) +
geom_boxplot(notch=TRUE)+
#geom_smooth(method = "lm")+
# geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-50, 50)+
geom_signif(comparisons = list(c("Comb","Unfilt")),
y_position = 40, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
geom_signif(comparisons = list(c("GS","Comb")),
y_position = 35, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black")+
geom_signif(comparisons = list(c("Unfilt","GS")),
y_position = 30, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
#title = "",
subtitle = "                              (d)")+
scale_color_hue(labels=c('Comb', 'GS', 'Unfiltered'),name="Filter")+
theme(legend.position = c(0.8, 0.2))
#pdf("conf2_ver2.pdf")
suppressWarnings(print(p1/(p2-p3)))
#dev.off()
mean_err_type<-occ_err_long %>% group_by(Occ_Error_Type)  %>% summarise( "Mean"= round(mean(Error),2), "RMS"=round(sqrt(mean(Error^2)),2),"Est"='Before Correction')
anova(lm(Effort_Amp_err ~ Filt, data =  occ_err1))
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log)%>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_Indv_err),2), "RMS"=round(sqrt(mean(Effort_Amp_Indv_err^2)),2),"Est"='Individualized Correction',"Log"=Log) )
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log) %>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_err),2), "RMS"=round(sqrt(mean(Effort_Amp_err^2)),2),"Est"='After Correction',"Log"=Log) )
filt="GS"
type='Occ_Hybrid_mvc'
Log=TRUE
occ_err<-filter(err, MVC_Stim_Cat!="Stim_0",Filt==filt, Occ_Type!=type,LogModel==Log)%>%
select(Occ_Type,Effort_Amp_err,Effort_e_Amp_err,MVC_Stim_Cat,VoliMVC)
occ_err_wide<-occ_err %>% pivot_wider(names_from = Occ_Type, values_from = Effort_Amp_err)
occ_err_long<-occ_err_wide%>%pivot_longer(cols=c('Occ_mvc','Occ_Dropped_mvc','Effort_e_Amp_err'),
names_to='Occ_Error_Type',
values_to='Error')%>%mutate(Occ_Error_Type = as.factor(Occ_Error_Type))
#%>%mutate(Occ_Error_Type=recode(
#                                     Occ_Error_Type,'Effort_e_Amp_err' = 'Uncorrected',
#                                    'Occ_mvc' = 'Occlusion Corrected',
#                                   'Occ_Dropped_mvc' = 'Dropped Frames\nBased'
#                                  ))
occ_err1<-filter(err, MVC_Stim_Cat!="Stim_0",Occ_Type=="Occ_mvc")
occ_err_long<-filter(occ_err_long, Occ_Error_Type!="Occ_Dropped_mvc")
occ_err_long <- occ_err_long %>%
mutate(Occ_Error_Type = relevel(Occ_Error_Type, ref = "Effort_e_Amp_err"))
my_labeller <- as_labeller(c(Occ_mvc="E[o]+E[e]", Effort_e_Amp_err="E[e]"),
default = label_parsed)
p1<-ggplot(occ_err_long, aes(x =  VoliMVC , y = Error , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 9, y = 0, xend = 41, yend = 0, color='Zero Error'))+
facet_wrap(~Occ_Error_Type,labeller=my_labeller)+
ylim(-50, 20)+
labs(x = expression("Volitional Effort (E"[v]*") "),
y = "Effort Estimation Error (% Effort)",
subtitle = sprintf('                                 (a)                                                                  (b)                           ',type, filt))+
scale_color_hue(labels=c('10% Stim', '20% Stim', '30% Stim','Zero Error'),name=expression("Stim. Effort (E"[s]*")"))+
theme(legend.position = c(0.6, 0.3))
p2<-ggplot(occ_err_long, aes(x =  Occ_Error_Type , y = Error,color=Occ_Error_Type )) +
geom_boxplot(notch=TRUE)+
ylim(-55, 25)+
geom_signif(comparisons = list(c("Occ_mvc","Effort_e_Amp_err")),
y_position = 15, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
subtitle = "                                 (c)  ")+
scale_color_hue(labels=c('Occlusion Corrected', 'Uncorrected', 'Force Based'),name="Correction")+
theme(legend.position = c(0.7, 0.2))
p3<-ggplot(occ_err1, aes(x =  Filt , y = Effort_Amp_err , color = Filt)) +
geom_boxplot(notch=TRUE)+
#geom_smooth(method = "lm")+
# geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-50, 50)+
geom_signif(comparisons = list(c("Comb","Unfilt")),
y_position = 40, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
geom_signif(comparisons = list(c("GS","Comb")),
y_position = 35, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black")+
geom_signif(comparisons = list(c("Unfilt","GS")),
y_position = 30, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
#title = "",
subtitle = "                              (d)")+
scale_color_hue(labels=c('Comb', 'GS', 'Unfiltered'),name="Filter")+
theme(legend.position = c(0.8, 0.2))
#pdf("conf2_ver2.pdf")
suppressWarnings(print(p1/(p2-p3)))
#dev.off()
mean_err_type<-occ_err_long %>% group_by(Occ_Error_Type)  %>% summarise( "Mean"= round(mean(Error),2), "RMS"=round(sqrt(mean(Error^2)),2),"Est"='Before Correction')
anova(lm(Effort_Amp_err ~ Filt, data =  occ_err1))
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log)%>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_Indv_err),2), "RMS"=round(sqrt(mean(Effort_Amp_Indv_err^2)),2),"Est"='Individualized Correction',"Log"=Log) )
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log) %>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_err),2), "RMS"=round(sqrt(mean(Effort_Amp_err^2)),2),"Est"='After Correction',"Log"=Log) )
filt="GS"
type='Occ_Hybrid_mvc'
Log=TRUE
occ_err<-filter(err, MVC_Stim_Cat!="Stim_0",Filt==filt, Occ_Type!=type,LogModel==Log)%>%
select(Occ_Type,Effort_Amp_err,Effort_e_Amp_err,MVC_Stim_Cat,VoliMVC)
occ_err_wide<-occ_err %>% pivot_wider(names_from = Occ_Type, values_from = Effort_Amp_err)
occ_err_long<-occ_err_wide%>%pivot_longer(cols=c('Occ_mvc','Occ_Dropped_mvc','Effort_e_Amp_err'),
names_to='Occ_Error_Type',
values_to='Error')%>%mutate(Occ_Error_Type = as.factor(Occ_Error_Type))
#%>%mutate(Occ_Error_Type=recode(
#                                     Occ_Error_Type,'Effort_e_Amp_err' = 'Uncorrected',
#                                    'Occ_mvc' = 'Occlusion Corrected',
#                                   'Occ_Dropped_mvc' = 'Dropped Frames\nBased'
#                                  ))
occ_err1<-filter(err, MVC_Stim_Cat!="Stim_0",Occ_Type=="Occ_mvc")
occ_err_long<-filter(occ_err_long, Occ_Error_Type!="Occ_Dropped_mvc")
occ_err_long <- occ_err_long %>%
mutate(Occ_Error_Type = relevel(Occ_Error_Type, ref = "Effort_e_Amp_err"))
my_labeller <- as_labeller(c(Occ_mvc="E[o]+E[e]", Effort_e_Amp_err="E[e]"),
default = label_parsed)
p1<-ggplot(occ_err_long, aes(x =  VoliMVC , y = Error , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 9, y = 0, xend = 41, yend = 0, color='Zero Error'))+
facet_wrap(~Occ_Error_Type,labeller=my_labeller)+
ylim(-50, 20)+
labs(x = expression("Volitional Effort (E"[v]*") "),
y = "Effort Estimation Error (% Effort)",
subtitle = sprintf('                                 (a)                                                                  (b)                           ',type, filt))+
scale_color_hue(labels=c('10% Stim', '20% Stim', '30% Stim','Zero Error'),name=expression("Stim. Effort (E"[s]*")"))+
theme(legend.position = c(0.6, 0.3))
p2<-ggplot(occ_err_long, aes(x =  Occ_Error_Type , y = Error,color=Occ_Error_Type )) +
geom_boxplot(notch=TRUE)+
ylim(-55, 25)+
geom_signif(comparisons = list(c("Occ_mvc","Effort_e_Amp_err")),
y_position = 15, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
subtitle = "                                 (c)  ")+
scale_color_hue(labels=c('Occlusion Corrected', 'Uncorrected', 'Force Based'),name="Correction")+
theme(legend.position = c(0.7, 0.2))
p3<-ggplot(occ_err1, aes(x =  Filt , y = Effort_Amp_err , color = Filt)) +
geom_boxplot(notch=TRUE)+
#geom_smooth(method = "lm")+
# geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-50, 50)+
geom_signif(comparisons = list(c("Comb","Unfilt")),
y_position = 40, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
geom_signif(comparisons = list(c("GS","Comb")),
y_position = 35, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black")+
geom_signif(comparisons = list(c("Unfilt","GS")),
y_position = 30, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
#title = "",
subtitle = "                              (d)")+
scale_color_hue(labels=c('Comb', 'GS', 'Unfiltered'),name="Filter")+
theme(legend.position = c(0.8, 0.2))
#pdf("conf2_ver2.pdf")
suppressWarnings(print(p1/(p2-p3)))
#dev.off()
anova(lm(Effort_Amp_err ~ Filt, data =  occ_err1))
#mean_err_type<-occ_err_long %>% group_by(Occ_Error_Type)  %>% summarise( "Mean"= round(mean(Error),2), "RMS"=round(sqrt(mean(Error^2)),2),"Est"='Before Correction')
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log)%>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_Indv_err),2), "RMS"=round(sqrt(mean(Effort_Amp_Indv_err^2)),2),"Est"='Individualized Correction',"Log"=Log) )
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log) %>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_err),2), "RMS"=round(sqrt(mean(Effort_Amp_err^2)),2),"Est"='After Correction',"Log"=Log) )
knitr::opts_chunk$set(echo = TRUE)
filt="GS"
type='Occ_Hybrid_mvc'
Log=TRUE
occ_err<-filter(err, MVC_Stim_Cat!="Stim_0",Filt==filt, Occ_Type!=type,LogModel==Log)%>%
select(Occ_Type,Effort_Amp_err,Effort_e_Amp_err,MVC_Stim_Cat,VoliMVC)
occ_err_wide<-occ_err %>% pivot_wider(names_from = Occ_Type, values_from = Effort_Amp_err)
occ_err_long<-occ_err_wide%>%pivot_longer(cols=c('Occ_mvc','Occ_Dropped_mvc','Effort_e_Amp_err'),
names_to='Occ_Error_Type',
values_to='Error')%>%mutate(Occ_Error_Type = as.factor(Occ_Error_Type))
#%>%mutate(Occ_Error_Type=recode(
#                                     Occ_Error_Type,'Effort_e_Amp_err' = 'Uncorrected',
#                                    'Occ_mvc' = 'Occlusion Corrected',
#                                   'Occ_Dropped_mvc' = 'Dropped Frames\nBased'
#                                  ))
occ_err1<-filter(err, MVC_Stim_Cat!="Stim_0",Occ_Type=="Occ_mvc")
occ_err_long<-filter(occ_err_long, Occ_Error_Type!="Occ_Dropped_mvc")
occ_err_long <- occ_err_long %>%
mutate(Occ_Error_Type = relevel(Occ_Error_Type, ref = "Effort_e_Amp_err"))
my_labeller <- as_labeller(c(Occ_mvc="E[o]+E[e]", Effort_e_Amp_err="E[e]"),
default = label_parsed)
p1<-ggplot(occ_err_long, aes(x =  VoliMVC , y = Error , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 9, y = 0, xend = 41, yend = 0, color='Zero Error'))+
facet_wrap(~Occ_Error_Type,labeller=my_labeller)+
ylim(-50, 20)+
labs(x = expression("Volitional Effort (E"[v]*") "),
y = "Effort Estimation Error (% Effort)",
subtitle = sprintf('                                 (a)                                                                  (b)                           ',type, filt))+
scale_color_hue(labels=c('10% Stim', '20% Stim', '30% Stim','Zero Error'),name=expression("Stim. Effort (E"[s]*")"))+
theme(legend.position = c(0.6, 0.3))
p2<-ggplot(occ_err_long, aes(x =  Occ_Error_Type , y = Error,color=Occ_Error_Type )) +
geom_boxplot(notch=TRUE)+
ylim(-55, 25)+
geom_signif(comparisons = list(c("Occ_mvc","Effort_e_Amp_err")),
y_position = 15, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
subtitle = "                                 (c)  ")+
scale_color_hue(labels=c('Occlusion Corrected', 'Uncorrected', 'Force Based'),name="Correction")+
theme(legend.position = c(0.7, 0.2))
p3<-ggplot(occ_err1, aes(x =  Filt , y = Effort_Amp_err , color = Filt)) +
geom_boxplot(notch=TRUE)+
#geom_smooth(method = "lm")+
# geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-50, 50)+
geom_signif(comparisons = list(c("Comb","Unfilt")),
y_position = 40, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
geom_signif(comparisons = list(c("GS","Comb")),
y_position = 35, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black")+
geom_signif(comparisons = list(c("Unfilt","GS")),
y_position = 30, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
#title = "",
subtitle = "                              (d)")+
scale_color_hue(labels=c('Comb', 'GS', 'Unfiltered'),name="Filter")+
theme(legend.position = c(0.8, 0.2))
#pdf("conf2_ver2.pdf")
suppressWarnings(print(p1/(p2-p3)))
#dev.off()
anova(lm(Effort_Amp_err ~ Filt, data =  occ_err1))
#mean_err_type<-occ_err_long %>% group_by(Occ_Error_Type)  %>% summarise( "Mean"= round(mean(Error),2), "RMS"=round(sqrt(mean(Error^2)),2),"Est"='Before Correction')
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log)%>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_Indv_err),2), "RMS"=round(sqrt(mean(Effort_Amp_Indv_err^2)),2),"Est"='Individualized Correction',"Log"=Log) )
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log) %>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_err),2), "RMS"=round(sqrt(mean(Effort_Amp_err^2)),2),"Est"='After Correction',"Log"=Log) )
filt="GS"
type='Occ_Hybrid_mvc'
Log=TRUE
occ_err<-filter(err, MVC_Stim_Cat!="Stim_0",Filt==filt, Occ_Type!=type,LogModel==Log)%>%
select(Occ_Type,Effort_Amp_err,Effort_e_Amp_err,MVC_Stim_Cat,VoliMVC)
occ_err_wide<-occ_err %>% pivot_wider(names_from = Occ_Type, values_from = Effort_Amp_err)
occ_err_long<-occ_err_wide%>%pivot_longer(cols=c('Occ_mvc','Occ_Dropped_mvc','Effort_e_Amp_err'),
names_to='Occ_Error_Type',
values_to='Error')%>%mutate(Occ_Error_Type = as.factor(Occ_Error_Type))
#%>%mutate(Occ_Error_Type=recode(
#                                     Occ_Error_Type,'Effort_e_Amp_err' = 'Uncorrected',
#                                    'Occ_mvc' = 'Occlusion Corrected',
#                                   'Occ_Dropped_mvc' = 'Dropped Frames\nBased'
#                                  ))
occ_err1<-filter(err, MVC_Stim_Cat!="Stim_0",Occ_Type=="Occ_mvc")
occ_err_long<-filter(occ_err_long, Occ_Error_Type!="Occ_Dropped_mvc")
occ_err_long <- occ_err_long %>%
mutate(Occ_Error_Type = relevel(Occ_Error_Type, ref = "Effort_e_Amp_err"))
my_labeller <- as_labeller(c(Occ_mvc="E[o]+E[e]", Effort_e_Amp_err="E[e]"),
default = label_parsed)
p1<-ggplot(occ_err_long, aes(x =  VoliMVC , y = Error , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 9, y = 0, xend = 41, yend = 0, color='Zero Error'))+
facet_wrap(~Occ_Error_Type,labeller=my_labeller)+
ylim(-50, 20)+
labs(x = expression("Volitional Effort (E"[v]*") "),
y = "Effort Estimation Error (% Effort)",
subtitle = sprintf('                                 (a)                                                                  (b)                           ',type, filt))+
scale_color_hue(labels=c('10% Stim', '20% Stim', '30% Stim','Zero Error'),name=expression("Stim. Effort (E"[s]*")"))+
theme(legend.position = c(0.6, 0.3))
p2<-ggplot(occ_err_long, aes(x =  Occ_Error_Type , y = Error,color=Occ_Error_Type )) +
geom_boxplot(notch=TRUE)+
ylim(-55, 25)+
geom_signif(comparisons = list(c("Occ_mvc","Effort_e_Amp_err")),
y_position = 15, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
subtitle = "                                 (c)  ")+
scale_color_hue(labels=c('Occlusion Corrected', 'Uncorrected', 'Force Based'),name="Correction")+
theme(legend.position = c(0.7, 0.2))
p3<-ggplot(occ_err1, aes(x =  Filt , y = Effort_Amp_err , color = Filt)) +
geom_boxplot(notch=TRUE)+
#geom_smooth(method = "lm")+
# geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-50, 50)+
geom_signif(comparisons = list(c("Comb","Unfilt")),
y_position = 40, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
geom_signif(comparisons = list(c("GS","Comb")),
y_position = 35, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black")+
geom_signif(comparisons = list(c("Unfilt","GS")),
y_position = 30, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
#title = "",
subtitle = "                              (d)")+
scale_color_hue(labels=c('Comb', 'GS', 'Unfiltered'),name="Filter")+
theme(legend.position = c(0.8, 0.2))
#pdf("conf2_ver2.pdf")
suppressWarnings(print(p1/(p2-p3)))
#dev.off()
TukeyHSD(aov(Effort_Amp_err ~ Filt, data = occ_err1))
#mean_err_type<-occ_err_long %>% group_by(Occ_Error_Type)  %>% summarise( "Mean"= round(mean(Error),2), "RMS"=round(sqrt(mean(Error^2)),2),"Est"='Before Correction')
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log)%>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_Indv_err),2), "RMS"=round(sqrt(mean(Effort_Amp_Indv_err^2)),2),"Est"='Individualized Correction',"Log"=Log) )
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log) %>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_err),2), "RMS"=round(sqrt(mean(Effort_Amp_err^2)),2),"Est"='After Correction',"Log"=Log) )
filt="GS"
type='Occ_Hybrid_mvc'
Log=TRUE
occ_err<-filter(err, MVC_Stim_Cat!="Stim_0",Filt==filt, Occ_Type!=type,LogModel==Log)%>%
select(Occ_Type,Effort_Amp_err,Effort_e_Amp_err,MVC_Stim_Cat,VoliMVC)
occ_err_wide<-occ_err %>% pivot_wider(names_from = Occ_Type, values_from = Effort_Amp_err)
occ_err_long<-occ_err_wide%>%pivot_longer(cols=c('Occ_mvc','Occ_Dropped_mvc','Effort_e_Amp_err'),
names_to='Occ_Error_Type',
values_to='Error')%>%mutate(Occ_Error_Type = as.factor(Occ_Error_Type))
#%>%mutate(Occ_Error_Type=recode(
#                                     Occ_Error_Type,'Effort_e_Amp_err' = 'Uncorrected',
#                                    'Occ_mvc' = 'Occlusion Corrected',
#                                   'Occ_Dropped_mvc' = 'Dropped Frames\nBased'
#                                  ))
occ_err1<-filter(err, MVC_Stim_Cat!="Stim_0",Occ_Type=="Occ_mvc")
occ_err_long<-filter(occ_err_long, Occ_Error_Type!="Occ_Dropped_mvc")
occ_err_long <- occ_err_long %>%
mutate(Occ_Error_Type = relevel(Occ_Error_Type, ref = "Effort_e_Amp_err"))
my_labeller <- as_labeller(c(Occ_mvc="E[o]+E[e]", Effort_e_Amp_err="E[e]"),
default = label_parsed)
p1<-ggplot(occ_err_long, aes(x =  VoliMVC , y = Error , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 9, y = 0, xend = 41, yend = 0, color='Zero Error'))+
facet_wrap(~Occ_Error_Type,labeller=my_labeller)+
ylim(-50, 20)+
labs(x = expression("Volitional Effort (E"[v]*") "),
y = "Effort Estimation Error (% Effort)",
subtitle = sprintf('                                 (a)                                                                  (b)                           ',type, filt))+
scale_color_hue(labels=c('10% Stim', '20% Stim', '30% Stim','Zero Error'),name=expression("Stim. Effort (E"[s]*")"))+
theme(legend.position = c(0.6, 0.3))
p2<-ggplot(occ_err_long, aes(x =  Occ_Error_Type , y = Error,color=Occ_Error_Type )) +
geom_boxplot(notch=TRUE)+
ylim(-55, 25)+
geom_signif(comparisons = list(c("Occ_mvc","Effort_e_Amp_err")),
y_position = 15, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
subtitle = "                                 (c)  ")+
scale_color_hue(labels=c('Occlusion Corrected', 'Uncorrected', 'Force Based'),name="Correction")+
theme(legend.position = c(0.7, 0.2))
p3<-ggplot(occ_err1, aes(x =  Filt , y = Effort_Amp_err , color = Filt)) +
geom_boxplot(notch=TRUE)+
#geom_smooth(method = "lm")+
# geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-50, 50)+
geom_signif(comparisons = list(c("Comb","Unfilt")),
y_position = 40, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
geom_signif(comparisons = list(c("GS","Comb")),
y_position = 35, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black")+
geom_signif(comparisons = list(c("Unfilt","GS")),
y_position = 30, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
#title = "",
subtitle = "                              (d)")+
scale_color_hue(labels=c('Comb', 'GS', 'Unfiltered'),name="Filter")+
theme(legend.position = c(0.8, 0.2))
#pdf("conf2_ver2.pdf")
suppressWarnings(print(p1/(p2-p3)))
#dev.off()
anova(lm(Effort_Amp_err ~ Filt, data =  occ_err1))
TukeyHSD(aov(Effort_Amp_err ~ Filt, data = occ_err1))
#mean_err_type<-occ_err_long %>% group_by(Occ_Error_Type)  %>% summarise( "Mean"= round(mean(Error),2), "RMS"=round(sqrt(mean(Error^2)),2),"Est"='Before Correction')
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log)%>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_Indv_err),2), "RMS"=round(sqrt(mean(Effort_Amp_Indv_err^2)),2),"Est"='Individualized Correction',"Log"=Log) )
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log) %>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_err),2), "RMS"=round(sqrt(mean(Effort_Amp_err^2)),2),"Est"='After Correction',"Log"=Log) )
filt="GS"
type='Occ_Hybrid_mvc'
Log=TRUE
occ_err<-filter(err, MVC_Stim_Cat!="Stim_0",Filt==filt, Occ_Type!=type,LogModel==Log)%>%
select(Occ_Type,Effort_Amp_err,Effort_e_Amp_err,MVC_Stim_Cat,VoliMVC)
occ_err_wide<-occ_err %>% pivot_wider(names_from = Occ_Type, values_from = Effort_Amp_err)
occ_err_long<-occ_err_wide%>%pivot_longer(cols=c('Occ_mvc','Occ_Dropped_mvc','Effort_e_Amp_err'),
names_to='Occ_Error_Type',
values_to='Error')%>%mutate(Occ_Error_Type = as.factor(Occ_Error_Type))
#%>%mutate(Occ_Error_Type=recode(
#                                     Occ_Error_Type,'Effort_e_Amp_err' = 'Uncorrected',
#                                    'Occ_mvc' = 'Occlusion Corrected',
#                                   'Occ_Dropped_mvc' = 'Dropped Frames\nBased'
#                                  ))
occ_err1<-filter(err, MVC_Stim_Cat!="Stim_0",Occ_Type=="Occ_mvc")
occ_err_long<-filter(occ_err_long, Occ_Error_Type!="Occ_Dropped_mvc")
occ_err_long <- occ_err_long %>%
mutate(Occ_Error_Type = relevel(Occ_Error_Type, ref = "Effort_e_Amp_err"))
my_labeller <- as_labeller(c(Occ_mvc="E[o]+E[e]", Effort_e_Amp_err="E[e]"),
default = label_parsed)
p1<-ggplot(occ_err_long, aes(x =  VoliMVC , y = Error , color = MVC_Stim_Cat)) +
geom_point() +
geom_smooth(method = "lm")+
geom_segment(aes(x = 9, y = 0, xend = 41, yend = 0, color='Zero Error'))+
facet_wrap(~Occ_Error_Type,labeller=my_labeller)+
ylim(-50, 20)+
labs(x = expression("Volitional Effort (E"[v]*") "),
y = "Effort Estimation Error (% Effort)",
subtitle = sprintf('                                 (a)                                                                  (b)                           ',type, filt))+
scale_color_hue(labels=c('10% Stim', '20% Stim', '30% Stim','Zero Error'),name=expression("Stim. Effort (E"[s]*")"))+
theme(legend.position = c(0.6, 0.3))
p2<-ggplot(occ_err_long, aes(x =  Occ_Error_Type , y = Error,color=Occ_Error_Type )) +
geom_boxplot(notch=TRUE)+
ylim(-55, 25)+
geom_signif(comparisons = list(c("Occ_mvc","Effort_e_Amp_err")),
y_position = 15, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
subtitle = "                                 (c)  ")+
scale_color_hue(labels=c('Occlusion Corrected', 'Uncorrected', 'Force Based'),name="Correction")+
theme(legend.position = c(0.7, 0.2))
p3<-ggplot(occ_err1, aes(x =  Filt , y = Effort_Amp_err , color = Filt)) +
geom_boxplot(notch=TRUE)+
#geom_smooth(method = "lm")+
# geom_segment(aes(x = 10, y = 0, xend = 40, yend = 0, color='Zero Error'))+
ylim(-50, 50)+
geom_signif(comparisons = list(c("Comb","Unfilt")),
y_position = 40, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
geom_signif(comparisons = list(c("GS","Comb")),
y_position = 35, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black")+
geom_signif(comparisons = list(c("Unfilt","GS")),
y_position = 30, tip_length = 0.02, vjust = 0.1, map_signif_level=TRUE,annotation = c("*"),color = "black") +
labs(x = "Volitional Effort: E_v (% Effort)",
y = "Effort Estimation Error (% Effort)",
#title = "",
subtitle = "                              (d)")+
scale_color_hue(labels=c('Comb', 'GS', 'Unfiltered'),name="Filter")+
theme(legend.position = c(0.8, 0.2))
#pdf("conf2_ver2.pdf")
suppressWarnings(print(p1/(p2-p3)))
#dev.off()
anova(lm(Error ~ Occ_Error_Type, data =  occ_err_long))
TukeyHSD(aov(Error ~ Occ_Error_Type, data = occ_err_long))
anova(lm(Effort_Amp_err ~ Filt, data =  occ_err1))
TukeyHSD(aov(Effort_Amp_err ~ Filt, data = occ_err1))
#mean_err_type<-occ_err_long %>% group_by(Occ_Error_Type)  %>% summarise( "Mean"= round(mean(Error),2), "RMS"=round(sqrt(mean(Error^2)),2),"Est"='Before Correction')
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log)%>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_Indv_err),2), "RMS"=round(sqrt(mean(Effort_Amp_Indv_err^2)),2),"Est"='Individualized Correction',"Log"=Log) )
#mean_err<-mean_err%>%add_row(occ_err %>% filter(LogModel==Log) %>% group_by(MVC_Voli_Cat) %>% summarise( "Mean"= round(mean(Effort_Amp_err),2), "RMS"=round(sqrt(mean(Effort_Amp_err^2)),2),"Est"='After Correction',"Log"=Log) )
